<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>初识Node和内置模块 | 刘明凯的学习笔记</title>
    <meta name="description" content="本网站是基于GitHubPage和VitePress构建, 用来存放刘明凯的学习笔记">
    <link rel="preload stylesheet" href="/assets/style.e55bba4c.css" as="style">
    <script type="module" src="/assets/app.effd72c5.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.2ed14f66.woff2" as="font" type="font/woff2" crossorigin="">
  <link rel="modulepreload" href="/assets/chunks/framework.48c56699.js">
  <link rel="modulepreload" href="/assets/chunks/theme.7e6adc9c.js">
  <link rel="modulepreload" href="/assets/notes_front_Node.md.57ecb1bf.lean.js">
  <script id="check-dark-light">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-99cf8a88><!--[--><!--]--><!--[--><span tabindex="-1" data-v-ae3e3f51></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-ae3e3f51> Skip to content </a><!--]--><!----><header class="VPNav" data-v-99cf8a88 data-v-7e5bc4a5><div class="VPNavBar has-sidebar" data-v-7e5bc4a5 data-v-381568bf><div class="container" data-v-381568bf><div class="title" data-v-381568bf><div class="VPNavBarTitle has-sidebar" data-v-381568bf data-v-305adf00><a class="title" href="/" data-v-305adf00><!--[--><!--]--><!----><!--[-->刘明凯的学习笔记<!--]--><!--[--><!--]--></a></div></div><div class="content" data-v-381568bf><div class="curtain" data-v-381568bf></div><div class="content-body" data-v-381568bf><!--[--><!--]--><div class="VPNavBarSearch search" style="--vp-meta-key:&#39;Meta&#39;;" data-v-381568bf><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg class="DocSearch-Search-Icon" width="20" height="20" viewBox="0 0 20 20" aria-label="search icon"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-381568bf data-v-7f418b0f><span id="main-nav-aria-label" class="visually-hidden" data-v-7f418b0f>Main Navigation</span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/guide/ssm/" tabindex="0" data-v-7f418b0f data-v-5e623618><!--[-->SSM<!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/guide/front/" tabindex="0" data-v-7f418b0f data-v-5e623618><!--[-->前端<!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/guide/springcloud/" tabindex="0" data-v-7f418b0f data-v-5e623618><!--[-->SpringCloud<!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-381568bf data-v-f6a63727><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="toggle dark mode" aria-checked="false" data-v-f6a63727 data-v-82b282f1 data-v-f3c41672><span class="check" data-v-f3c41672><span class="icon" data-v-f3c41672><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-82b282f1><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-82b282f1><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-381568bf data-v-0394ad82 data-v-7bc22406><!--[--><a class="VPSocialLink" href="https://github.com/LMKKK" aria-label="github" target="_blank" rel="noopener" data-v-7bc22406 data-v-36371990><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><a class="VPSocialLink" href="https://itkkk.blog.csdn.net" aria-label="秋天Code的博客" target="_blank" rel="noopener" data-v-7bc22406 data-v-36371990><svg t="1688885876384" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1454" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><path d="M512 0c282.784 0 512 229.216 512 512s-229.216 512-512 512S0 794.784 0 512 229.216 0 512 0z m189.952 752l11.2-108.224c-31.904 9.536-100.928 16.128-147.712 16.128-134.464 0-205.728-47.296-195.328-146.304 11.584-110.688 113.152-145.696 232.64-145.696 54.784 0 122.432 8.8 151.296 18.336L768 272.704C724.544 262.24 678.272 256 599.584 256c-203.2 0-388.704 94.88-406.4 263.488C178.336 660.96 303.584 768 535.616 768c80.672 0 138.464-6.432 166.336-16z" fill="#CE000D" p-id="1455"></path></svg></a><a class="VPSocialLink" href="https://space.bilibili.com/2071205694" aria-label="我的bilibili" target="_blank" rel="noopener" data-v-7bc22406 data-v-36371990><svg t="1688885971929" class="icon" viewBox="0 0 1129 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1755" xmlns:xlink="http://www.w3.org/1999/xlink" width="220.5078125" height="200"><path d="M234.909 9.656a80.468 80.468 0 0 1 68.398 0 167.374 167.374 0 0 1 41.843 30.578l160.937 140.82h115.07l160.936-140.82a168.983 168.983 0 0 1 41.843-30.578A80.468 80.468 0 0 1 930.96 76.445a80.468 80.468 0 0 1-17.703 53.914 449.818 449.818 0 0 1-35.406 32.187 232.553 232.553 0 0 1-22.531 18.508h100.585a170.593 170.593 0 0 1 118.289 53.109 171.397 171.397 0 0 1 53.914 118.288v462.693a325.897 325.897 0 0 1-4.024 70.007 178.64 178.64 0 0 1-80.468 112.656 173.007 173.007 0 0 1-92.539 25.75h-738.7a341.186 341.186 0 0 1-72.421-4.024A177.835 177.835 0 0 1 28.91 939.065a172.202 172.202 0 0 1-27.36-92.539V388.662a360.498 360.498 0 0 1 0-66.789A177.03 177.03 0 0 1 162.487 178.64h105.414c-16.899-12.07-31.383-26.555-46.672-39.43a80.468 80.468 0 0 1-25.75-65.984 80.468 80.468 0 0 1 39.43-63.57M216.4 321.873a80.468 80.468 0 0 0-63.57 57.937 108.632 108.632 0 0 0 0 30.578v380.615a80.468 80.468 0 0 0 55.523 80.469 106.218 106.218 0 0 0 34.601 5.632h654.208a80.468 80.468 0 0 0 76.444-47.476 112.656 112.656 0 0 0 8.047-53.109v-354.06a135.187 135.187 0 0 0 0-38.625 80.468 80.468 0 0 0-52.304-54.719 129.554 129.554 0 0 0-49.89-7.242H254.22a268.764 268.764 0 0 0-37.82 0z m0 0" fill="#20B0E3" p-id="1756"></path><path d="M348.369 447.404a80.468 80.468 0 0 1 55.523 18.507 80.468 80.468 0 0 1 28.164 59.547v80.468a80.468 80.468 0 0 1-16.094 51.5 80.468 80.468 0 0 1-131.968-9.656 104.609 104.609 0 0 1-10.46-54.719v-80.468a80.468 80.468 0 0 1 70.007-67.593z m416.02 0a80.468 80.468 0 0 1 86.102 75.64v80.468a94.148 94.148 0 0 1-12.07 53.11 80.468 80.468 0 0 1-132.773 0 95.757 95.757 0 0 1-12.875-57.133V519.02a80.468 80.468 0 0 1 70.007-70.812z m0 0" fill="#20B0E3" p-id="1757"></path></svg></a><a class="VPSocialLink" href="https://www.yuque.com/kkcode/" aria-label target="_blank" rel="noopener" data-v-7bc22406 data-v-36371990><svg t="1688886279240" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2089" width="200" height="200"><path d="M228.7 643.9c-0.1 0.1-0.2 0.3-0.3 0.4 3.9-4.4 8-9 12-13.5-7.5 8.4-11.7 13.1-11.7 13.1z" fill="#1590E9" p-id="2090"></path><path d="M894 298.1l25.6-15.1c10.4-6.1 9.1-21.5-2.1-25.9l-12.3-4.8c-18-7.1-34.2-18.2-46.7-33-15.7-18.5-44.7-45.1-90.9-60.8-52.7-18-142.9-14.4-193.2-10.5-15.9 1.2-25 18.4-17.4 32.5 42.6 78.6 16.7 114.3-5.7 140.7-34.3 40.4-97.4 112.2-160.7 183.6 21.9-24.5 41.8-46.8 58.1-65.1 36.4-40.8 91.3-61.5 145.1-51.7 171.5 31.3 191 253.4-9.2 385.6 26.1-1.4 52.6-3.3 79.2-6 252.6-26 272.6-232.1 218-333.9-19.4-36.1-22.2-60.5-20.1-83.9 2-21.5 13.8-40.8 32.3-51.7z" fill="#99C236" p-id="2091"></path><path d="M212.8 704.5C241.1 672.9 316 589 390.7 504.7c-54.6 61.2-121.8 136.7-177.9 199.8z" fill="#1590E9" p-id="2092"></path><path d="M216.3 758.6c-19.5-2.5-28.2-25.6-15.5-40.6-51.7 58.3-91.7 103.5-99.1 112.6-24.1 29.5 247.7 97.9 482.6-56.8 0.1-0.1 0.3-0.2 0.4-0.3-156.5 8.2-298.5-5.9-368.4-14.9z" fill="#CAC134" p-id="2093"></path><path d="M593.9 387.9c-53.8-9.8-108.7 10.9-145.1 51.7-16.3 18.2-36.2 40.5-58.1 65.1C316 589 241.1 672.9 212.8 704.5c-4.1 4.6-8.1 9.1-12 13.5-12.7 14.9-4 38 15.5 40.6 69.9 9 211.9 23.1 368.3 15 200.2-132.3 180.8-354.4 9.3-385.7z" fill="#029F40" p-id="2094"></path></svg></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-381568bf data-v-40855f84 data-v-764effdf><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-764effdf><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-764effdf><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-764effdf><div class="VPMenu" data-v-764effdf data-v-e7ea1737><!----><!--[--><!--[--><!----><div class="group" data-v-40855f84><div class="item appearance" data-v-40855f84><p class="label" data-v-40855f84>Appearance</p><div class="appearance-action" data-v-40855f84><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="toggle dark mode" aria-checked="false" data-v-40855f84 data-v-82b282f1 data-v-f3c41672><span class="check" data-v-f3c41672><span class="icon" data-v-f3c41672><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-82b282f1><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-82b282f1><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div></div></div><div class="group" data-v-40855f84><div class="item social-links" data-v-40855f84><div class="VPSocialLinks social-links-list" data-v-40855f84 data-v-7bc22406><!--[--><a class="VPSocialLink" href="https://github.com/LMKKK" aria-label="github" target="_blank" rel="noopener" data-v-7bc22406 data-v-36371990><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><a class="VPSocialLink" href="https://itkkk.blog.csdn.net" aria-label="秋天Code的博客" target="_blank" rel="noopener" data-v-7bc22406 data-v-36371990><svg t="1688885876384" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1454" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><path d="M512 0c282.784 0 512 229.216 512 512s-229.216 512-512 512S0 794.784 0 512 229.216 0 512 0z m189.952 752l11.2-108.224c-31.904 9.536-100.928 16.128-147.712 16.128-134.464 0-205.728-47.296-195.328-146.304 11.584-110.688 113.152-145.696 232.64-145.696 54.784 0 122.432 8.8 151.296 18.336L768 272.704C724.544 262.24 678.272 256 599.584 256c-203.2 0-388.704 94.88-406.4 263.488C178.336 660.96 303.584 768 535.616 768c80.672 0 138.464-6.432 166.336-16z" fill="#CE000D" p-id="1455"></path></svg></a><a class="VPSocialLink" href="https://space.bilibili.com/2071205694" aria-label="我的bilibili" target="_blank" rel="noopener" data-v-7bc22406 data-v-36371990><svg t="1688885971929" class="icon" viewBox="0 0 1129 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1755" xmlns:xlink="http://www.w3.org/1999/xlink" width="220.5078125" height="200"><path d="M234.909 9.656a80.468 80.468 0 0 1 68.398 0 167.374 167.374 0 0 1 41.843 30.578l160.937 140.82h115.07l160.936-140.82a168.983 168.983 0 0 1 41.843-30.578A80.468 80.468 0 0 1 930.96 76.445a80.468 80.468 0 0 1-17.703 53.914 449.818 449.818 0 0 1-35.406 32.187 232.553 232.553 0 0 1-22.531 18.508h100.585a170.593 170.593 0 0 1 118.289 53.109 171.397 171.397 0 0 1 53.914 118.288v462.693a325.897 325.897 0 0 1-4.024 70.007 178.64 178.64 0 0 1-80.468 112.656 173.007 173.007 0 0 1-92.539 25.75h-738.7a341.186 341.186 0 0 1-72.421-4.024A177.835 177.835 0 0 1 28.91 939.065a172.202 172.202 0 0 1-27.36-92.539V388.662a360.498 360.498 0 0 1 0-66.789A177.03 177.03 0 0 1 162.487 178.64h105.414c-16.899-12.07-31.383-26.555-46.672-39.43a80.468 80.468 0 0 1-25.75-65.984 80.468 80.468 0 0 1 39.43-63.57M216.4 321.873a80.468 80.468 0 0 0-63.57 57.937 108.632 108.632 0 0 0 0 30.578v380.615a80.468 80.468 0 0 0 55.523 80.469 106.218 106.218 0 0 0 34.601 5.632h654.208a80.468 80.468 0 0 0 76.444-47.476 112.656 112.656 0 0 0 8.047-53.109v-354.06a135.187 135.187 0 0 0 0-38.625 80.468 80.468 0 0 0-52.304-54.719 129.554 129.554 0 0 0-49.89-7.242H254.22a268.764 268.764 0 0 0-37.82 0z m0 0" fill="#20B0E3" p-id="1756"></path><path d="M348.369 447.404a80.468 80.468 0 0 1 55.523 18.507 80.468 80.468 0 0 1 28.164 59.547v80.468a80.468 80.468 0 0 1-16.094 51.5 80.468 80.468 0 0 1-131.968-9.656 104.609 104.609 0 0 1-10.46-54.719v-80.468a80.468 80.468 0 0 1 70.007-67.593z m416.02 0a80.468 80.468 0 0 1 86.102 75.64v80.468a94.148 94.148 0 0 1-12.07 53.11 80.468 80.468 0 0 1-132.773 0 95.757 95.757 0 0 1-12.875-57.133V519.02a80.468 80.468 0 0 1 70.007-70.812z m0 0" fill="#20B0E3" p-id="1757"></path></svg></a><a class="VPSocialLink" href="https://www.yuque.com/kkcode/" aria-label target="_blank" rel="noopener" data-v-7bc22406 data-v-36371990><svg t="1688886279240" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2089" width="200" height="200"><path d="M228.7 643.9c-0.1 0.1-0.2 0.3-0.3 0.4 3.9-4.4 8-9 12-13.5-7.5 8.4-11.7 13.1-11.7 13.1z" fill="#1590E9" p-id="2090"></path><path d="M894 298.1l25.6-15.1c10.4-6.1 9.1-21.5-2.1-25.9l-12.3-4.8c-18-7.1-34.2-18.2-46.7-33-15.7-18.5-44.7-45.1-90.9-60.8-52.7-18-142.9-14.4-193.2-10.5-15.9 1.2-25 18.4-17.4 32.5 42.6 78.6 16.7 114.3-5.7 140.7-34.3 40.4-97.4 112.2-160.7 183.6 21.9-24.5 41.8-46.8 58.1-65.1 36.4-40.8 91.3-61.5 145.1-51.7 171.5 31.3 191 253.4-9.2 385.6 26.1-1.4 52.6-3.3 79.2-6 252.6-26 272.6-232.1 218-333.9-19.4-36.1-22.2-60.5-20.1-83.9 2-21.5 13.8-40.8 32.3-51.7z" fill="#99C236" p-id="2091"></path><path d="M212.8 704.5C241.1 672.9 316 589 390.7 504.7c-54.6 61.2-121.8 136.7-177.9 199.8z" fill="#1590E9" p-id="2092"></path><path d="M216.3 758.6c-19.5-2.5-28.2-25.6-15.5-40.6-51.7 58.3-91.7 103.5-99.1 112.6-24.1 29.5 247.7 97.9 482.6-56.8 0.1-0.1 0.3-0.2 0.4-0.3-156.5 8.2-298.5-5.9-368.4-14.9z" fill="#CAC134" p-id="2093"></path><path d="M593.9 387.9c-53.8-9.8-108.7 10.9-145.1 51.7-16.3 18.2-36.2 40.5-58.1 65.1C316 589 241.1 672.9 212.8 704.5c-4.1 4.6-8.1 9.1-12 13.5-12.7 14.9-4 38 15.5 40.6 69.9 9 211.9 23.1 368.3 15 200.2-132.3 180.8-354.4 9.3-385.7z" fill="#029F40" p-id="2094"></path></svg></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-381568bf data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div></div><!----></header><div class="VPLocalNav" data-v-99cf8a88 data-v-a97031cc><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-a97031cc><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="menu-icon" data-v-a97031cc><path d="M17,11H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,11,17,11z"></path><path d="M21,7H3C2.4,7,2,6.6,2,6s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,7,21,7z"></path><path d="M21,15H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,15,21,15z"></path><path d="M17,19H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,19,17,19z"></path></svg><span class="menu-text" data-v-a97031cc>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-a97031cc data-v-687955bc><button data-v-687955bc>Return to top</button><!----></div></div><aside class="VPSidebar" data-v-99cf8a88 data-v-54885d6c><div class="curtain" data-v-54885d6c></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-54885d6c><span class="visually-hidden" id="sidebar-aria-label" data-v-54885d6c> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="group" data-v-54885d6c><section class="VPSidebarItem level-0 has-active" data-v-54885d6c data-v-c4656e6d><!----><div class="items" data-v-c4656e6d><!--[--><div class="VPSidebarItem level-1 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/notes/front/HTML+CSS.html" data-v-c4656e6d><!--[--><p class="text" data-v-c4656e6d>HTML+CSS</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/notes/front/HTML5.html" data-v-c4656e6d><!--[--><p class="text" data-v-c4656e6d>HTML5</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/notes/front/JS%E6%B1%87%E6%80%BB.html" data-v-c4656e6d><!--[--><p class="text" data-v-c4656e6d>JS汇总</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/notes/front/TS.html" data-v-c4656e6d><!--[--><p class="text" data-v-c4656e6d>TS</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link is-active has-active" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/notes/front/Node.html" data-v-c4656e6d><!--[--><p class="text" data-v-c4656e6d>Node</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/notes/front/Vue2.html" data-v-c4656e6d><!--[--><p class="text" data-v-c4656e6d>Vue2</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-c4656e6d data-v-c4656e6d><div class="item" data-v-c4656e6d><div class="indicator" data-v-c4656e6d></div><a class="VPLink link link" href="/notes/front/Vue3.html" data-v-c4656e6d><!--[--><p class="text" data-v-c4656e6d>Vue3</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-99cf8a88 data-v-97b5189c><div class="VPDoc has-sidebar has-aside" data-v-97b5189c data-v-e9631fd0><!--[--><!--]--><div class="container" data-v-e9631fd0><div class="aside" data-v-e9631fd0><div class="aside-curtain" data-v-e9631fd0></div><div class="aside-container" data-v-e9631fd0><div class="aside-content" data-v-e9631fd0><div class="VPDocAside" data-v-e9631fd0 data-v-3f215769><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline" data-v-3f215769 data-v-ff0f39c8><div class="content" data-v-ff0f39c8><div class="outline-marker" data-v-ff0f39c8></div><div class="outline-title" data-v-ff0f39c8>On this page</div><nav aria-labelledby="doc-outline-aria-label" data-v-ff0f39c8><span class="visually-hidden" id="doc-outline-aria-label" data-v-ff0f39c8> Table of Contents for current page </span><ul class="root" data-v-ff0f39c8 data-v-b0ff2abe><!--[--><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-3f215769></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-e9631fd0><div class="content-container" data-v-e9631fd0><!--[--><!--]--><!----><main class="main" data-v-e9631fd0><div style="position:relative;" class="vp-doc _notes_front_Node" data-v-e9631fd0><div><h1 id="初识node和内置模块" tabindex="-1">初识Node和内置模块 <a class="header-anchor" href="#初识node和内置模块" aria-label="Permalink to &quot;初识Node和内置模块&quot;">​</a></h1><h2 id="初识node-js" tabindex="-1">初识node.js <a class="header-anchor" href="#初识node-js" aria-label="Permalink to &quot;初识node.js&quot;">​</a></h2><h3 id="在node-js环境中执行javascript代码" tabindex="-1">在node.js环境中执行JavaScript代码 <a class="header-anchor" href="#在node-js环境中执行javascript代码" aria-label="Permalink to &quot;在node.js环境中执行JavaScript代码&quot;">​</a></h3><ol><li>打开终端</li><li>输入 <code>node 待执行文件路径</code></li></ol><h4 id="终端中的快捷键" tabindex="-1">终端中的快捷键 <a class="header-anchor" href="#终端中的快捷键" aria-label="Permalink to &quot;终端中的快捷键&quot;">​</a></h4><ul><li>使用<code>↑</code> , 上一条命令</li><li>使用<code>tab</code> 能够快速补全路径</li><li>使用能够<code>esc</code> 能够快速清空当前已输入的命令</li><li><code>cls</code>命令 , 清空终端</li></ul><p><strong>初始化项目</strong></p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">npm init </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">y</span></span></code></pre></div><p><strong>启动项目</strong></p><div class="language-dos"><button title="Copy Code" class="copy"></button><span class="lang">dos</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">node project.js</span></span></code></pre></div><h2 id="fs文件系统模块" tabindex="-1">fs文件系统模块 <a class="header-anchor" href="#fs文件系统模块" aria-label="Permalink to &quot;fs文件系统模块&quot;">​</a></h2><h3 id="什么是fs文件系统模块" tabindex="-1">什么是fs文件系统模块 <a class="header-anchor" href="#什么是fs文件系统模块" aria-label="Permalink to &quot;什么是fs文件系统模块&quot;">​</a></h3><p>fs模块时node.js官方提供的 , 用来操作文件的模块 , 他提供了一系列的方法和属性 , 用来满足用户对文件的操作需求</p><p>例如</p><ul><li><code>fs.readFile()</code> , 用来读取指定文件中的内容</li><li><code>fs.writeFile()</code> 用来向指定文件中写入内容</li></ul><p><strong>导入文件系统模块</strong></p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> fs </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">require</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">fs</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><h3 id="读取指定文件中的内容" tabindex="-1">读取指定文件中的内容 <a class="header-anchor" href="#读取指定文件中的内容" aria-label="Permalink to &quot;读取指定文件中的内容&quot;">​</a></h3><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">readFile</span><span style="color:#A6ACCD;">(path</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">[options]</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">callback)</span><span style="color:#89DDFF;">;</span></span></code></pre></div><ul><li><code>path</code> 必选参数, 表示文件的路径</li><li><code>options</code> 可选参数 , 表示以什么编码格式来读取文件</li><li><code>callback</code> 回调函数 , 通过此函数拿到读取的结果</li></ul><p>使用fs模块的前提是在代码中导入该模块</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> fs </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">require</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">fs</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span></code></pre></div><p><strong>使用fs.readFile()读取文件内容</strong></p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> fs </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">require</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">fs</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">readFile</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./files/test.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">utf8</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#C792EA;">function</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">err</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">dataStr</span><span style="color:#89DDFF;">){</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">err</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">文件读取失败</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;">err</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">message</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">文件读取成功</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;">dataStr</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">/*</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">此处的回调函数有两个参数</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">第一个参数err : 是文件读取失败的返回值 , 若文件读取成功则err=null,否则err为错误对象</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">第二个参数dataStr: 是文件内容字符串 , 若文件读取成功 , 则dataStr是字符串,若文件读取失败则是undefined</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">*/</span></span></code></pre></div><h3 id="向指定文件中写入内容" tabindex="-1">向指定文件中写入内容 <a class="header-anchor" href="#向指定文件中写入内容" aria-label="Permalink to &quot;向指定文件中写入内容&quot;">​</a></h3><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">writeFile</span><span style="color:#A6ACCD;">(file</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">data</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">[options]</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">callback)</span><span style="color:#89DDFF;">;</span></span></code></pre></div><ul><li><code>file</code> 文件路径</li><li><code>data</code> 要写入的内容 , 是一个字符串</li><li><code>options</code> 可选参数, 可以指定以什么编码格式写入文件内容,<strong>默认是utf8</strong></li><li><code>callback</code> 回调函数</li><li>待写入的文件不存在时,会自动创建该文件</li></ul><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> fs </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">require</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">fs</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">writeFile</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./files/test.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">hello node.js!</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">err</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">err</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">文件写入失败</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">+</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">err</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">message</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">文件写入成功</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">/*</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">此处的回调函数只有一个err</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">err: 如果写入成功, 则err=null , 否则 err=一个错误对象</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">写入时会重新删除原来的内容</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">*/</span></span></code></pre></div><p>注意:</p><ul><li><code>fs.writeFile()</code>只能用于创建文件, 不能用于创建路径</li><li><code>fs.writeFile()</code> 新写入的内容会覆盖旧的内容</li></ul><h3 id="动态路径拼接" tabindex="-1">动态路径拼接 <a class="header-anchor" href="#动态路径拼接" aria-label="Permalink to &quot;动态路径拼接&quot;">​</a></h3><p>在使用<code>fs.readFile()</code> 和<code> fs.writeFile()</code> 方法时 , 若传入的参数是一个相对路径,即路径中带有<code>./</code> 或者<code>../</code> , 那么在执行时很容易发生错误</p><p>这是因为<code>node</code>命令是在当前目录下的一个命令,所以会发生错误</p><p>解决方案: <strong>直接提供绝对路径</strong></p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">d:</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">test</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">node</span><span style="color:#A6ACCD;">\\</span><span style="color:#C3E88D;">hello.js</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">这样的路径是一个写死的字符串</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> 且不易移植 </span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> 维护性较差</span></span></code></pre></div><p><strong>那么可以使用一个专门的对象, 专门用来提供当前的绝对路径</strong></p><p><code>__dirname</code> 表示当前的绝对路径, 我们只需要拼接上待执行文件的文件名即可</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#A6ACCD;">(__dirname)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">readFile</span><span style="color:#A6ACCD;">(__dirname</span><span style="color:#89DDFF;">+</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/file/test.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">但是使用加号也会出现拼接错误的问题</span></span>
<span class="line"><span style="color:#A6ACCD;">例如</span></span>
<span class="line"><span style="color:#A6ACCD;">fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">readFile</span><span style="color:#A6ACCD;">(__dirname</span><span style="color:#89DDFF;">+</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./file/test.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#A6ACCD;">(__dirname</span><span style="color:#89DDFF;">+</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./file/test.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">这样这个路径就变成了 </span><span style="color:#FFCB6B;">d</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">\test\</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">\file\test</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">txt 这样显示是不正确的路径</span></span></code></pre></div><p>接下来的<code>path</code>模块为我们提供了一个路径拼接的方法</p><h2 id="path路径模块" tabindex="-1">path路径模块 <a class="header-anchor" href="#path路径模块" aria-label="Permalink to &quot;path路径模块&quot;">​</a></h2><h3 id="什么是path路径模块" tabindex="-1">什么是path路径模块 <a class="header-anchor" href="#什么是path路径模块" aria-label="Permalink to &quot;什么是path路径模块&quot;">​</a></h3><p><code>path</code>模块是Node.js官方提供的, 用来处理路径的模块,他提供了一系列的方法和属性,用来满足用户<strong>对路径的处理需求</strong></p><p>例如,常用的</p><ul><li><code>path.join()</code> 用来将多个路径片段拼接成一个完整的路径字符串</li><li><code>path.basename()</code> 用来从路径字符串中, 将文件名解析出来</li></ul><p>还是一样, 想要在代码中使用<code>path</code>模块, 需要导入</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> path </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">require</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">path</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span></code></pre></div><h3 id="路径拼接" tabindex="-1">路径拼接 <a class="header-anchor" href="#路径拼接" aria-label="Permalink to &quot;路径拼接&quot;">​</a></h3><p>在上面讲到的<code>__dirname</code>时 , 使用<code>+</code>号 拼接也会出现问题, 那么<code>path.join()</code>就解决了这个问题</p><p>使用<code>path.join()</code> , 可以把多个片段拼接成一个完整的路径字符串</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">join</span><span style="color:#A6ACCD;">([</span><span style="color:#89DDFF;">...</span><span style="color:#A6ACCD;">paths])</span><span style="color:#89DDFF;">;</span></span></code></pre></div><ul><li><code>...paths</code> 多个路径的片段</li><li>返回值是一个 <code>string</code>字符串</li><li>使用<code>path.join()</code>就可以避免使用<code>+</code>号带来拼接路径错误</li></ul><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> path </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">require</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">path</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#C792EA;">var</span><span style="color:#A6ACCD;"> pathStr </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">join</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/a</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/b/c</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">../</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./d</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">e</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#A6ACCD;">(pathStr)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">var</span><span style="color:#A6ACCD;"> pathStr2 </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">join</span><span style="color:#A6ACCD;">(__dirname</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./files/test.txt</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#A6ACCD;">(pathStr2)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">/*</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">会自动的去识别 ../ 和 ./ </span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">自动的完成拼接</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">*/</span></span></code></pre></div><h3 id="获取路径中的文件名" tabindex="-1">获取路径中的文件名 <a class="header-anchor" href="#获取路径中的文件名" aria-label="Permalink to &quot;获取路径中的文件名&quot;">​</a></h3><p>使用<code>path.basename()</code>方法可以获取路径中的最后一部分 , 经常通过这个方法获取路径中的文件名</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">basename</span><span style="color:#A6ACCD;">(path[</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">ext])</span><span style="color:#89DDFF;">;</span></span></code></pre></div><ul><li><code>path</code> 必选参数, 表示一个路径的字符串</li><li><code>ext</code> 可选参数 , 表示文件拓展名, 指定了拓展名之后,就不会返回文件的后缀, 只返回文件名</li><li>返回值一个<code>string</code>字符串</li></ul><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">var</span><span style="color:#A6ACCD;"> fpath </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/a/b/c/index.html</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#C792EA;">var</span><span style="color:#A6ACCD;"> fullName </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">basename</span><span style="color:#A6ACCD;">(fpath)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#A6ACCD;">(fullName)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//输出index.html</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">var</span><span style="color:#A6ACCD;"> nameWithoutExt </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">basename</span><span style="color:#A6ACCD;">(fpath</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.html</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#A6ACCD;">(nameWithoutExt)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//输出index</span></span></code></pre></div><h3 id="获取路径中的文件拓展名" tabindex="-1">获取路径中的文件拓展名 <a class="header-anchor" href="#获取路径中的文件拓展名" aria-label="Permalink to &quot;获取路径中的文件拓展名&quot;">​</a></h3><p>使用<code>path.extname()</code>方法 , 可以获取路径中的拓展名部分</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">extname</span><span style="color:#A6ACCD;">(path)</span><span style="color:#89DDFF;">;</span></span></code></pre></div><ul><li><code>path</code>必选参数 , , 路径的字符串</li><li>返回一个<code>string</code> 字符串</li></ul><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> path </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">require</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">path</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">var</span><span style="color:#A6ACCD;"> fext </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">extname</span><span style="color:#A6ACCD;">(fpath)</span></span>
<span class="line"><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#A6ACCD;">(fext)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//输出.html</span></span></code></pre></div><h2 id="http-模块" tabindex="-1">http 模块 <a class="header-anchor" href="#http-模块" aria-label="Permalink to &quot;http 模块&quot;">​</a></h2><h3 id="什么是http模块" tabindex="-1">什么是http模块 <a class="header-anchor" href="#什么是http模块" aria-label="Permalink to &quot;什么是http模块&quot;">​</a></h3><p>首先要知道什么是<strong>客户端和服务器</strong>，在网络中, 负责消耗资源的电脑叫做 客户端 , 负责对外提供网络资源的电脑 , 叫做服务器。</p><p><code>http</code> 模块是Node.js官方提供的, 用于<strong>创建Web服务器的模块</strong> , 通过调用提供的<code>http.createServer()</code>方法 , 就能方便的把电脑变成服务器 , 从而对外部提供Web资源。</p><p>还是老样子 , 要想使用http模块, 需要导入</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> http </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">require</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">http</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span></code></pre></div><h3 id="进一步了解http模块的作用" tabindex="-1">进一步了解http模块的作用 <a class="header-anchor" href="#进一步了解http模块的作用" aria-label="Permalink to &quot;进一步了解http模块的作用&quot;">​</a></h3><p>服务器和客户端的区别在于 , 服务器上安装了web服务器软件 , 例如: <code>IIS</code> , <code>Apache</code> , 通过安装这些服务器软件,就能把电脑变成服务器</p><p>在Node.js 中 , 我们不需要使用<code>IIS</code>, <code>Apache</code>等这些第三方web服务器软件</p><p>因为我们可以基于Node.js提供的http模块 , 通过简单的代码 , 就能轻松的手写一个服务器软件 ,</p><p>从而对外提供web服务</p><h3 id="服务器相关的概念" tabindex="-1">服务器相关的概念 <a class="header-anchor" href="#服务器相关的概念" aria-label="Permalink to &quot;服务器相关的概念&quot;">​</a></h3><h4 id="ip地址" tabindex="-1">IP地址 <a class="header-anchor" href="#ip地址" aria-label="Permalink to &quot;IP地址&quot;">​</a></h4><p>IP 地址就是互联网上每台计算机的唯一地址</p><p>常用的是IPv4的地址格式 , <code>a.b.c.d</code> ,其中每个字母都是<code>0~~255</code>之间的十进制整数</p><p>例如</p><ul><li>本地回环地址 <code>127.0.0.1</code> , 代表本地主机</li><li>路由地址<code>192.168.0.1</code></li></ul><p>注意</p><ul><li>互联网中的每台服务器 , 都有自己的IP地址 , 例如可以在终端中 <code>ping www.baidu.com</code> , 查看百度服务器的IP地址</li><li>在开发期间 , 自己的电脑既可以是服务器, 也可以是客户端 , 可以在浏览器中输入<code>127.0.01</code>,把自己的电脑当做服务器访问</li></ul><h4 id="域名和域名服务器" tabindex="-1">域名和域名服务器 <a class="header-anchor" href="#域名和域名服务器" aria-label="Permalink to &quot;域名和域名服务器&quot;">​</a></h4><p>IP地址不方便记忆, 不直观易懂 , 所以又出现了域名,例如<code>www.baidu.com</code>就是百度服务器IP地址的映射的域名 , 相对于百度的IP地址 , 域名更方便我们记忆理解,我们可以通过域名来访问百度的服务器</p><p><strong>域名和IP地址是一一对应的关系</strong> , 根据域名解析出对应的IP地址, 就需要用到一个<strong>域名服务器</strong></p><p>注意</p><ul><li>单纯地使用IP地址 , 互联网中的电脑是能够正常工作的 , 但是有了域名 , 能够让互联网世界变得更加方便</li><li>在开发测试期间 , <code>127.0.0.1</code> 对应的域名就是<code>localhost</code> ,代指本机</li></ul><h4 id="端口号" tabindex="-1">端口号 <a class="header-anchor" href="#端口号" aria-label="Permalink to &quot;端口号&quot;">​</a></h4><p>电脑上的端口是用来放程序的地方 , 也可以理解为服务程序存放的端口</p><p>每个电脑上可以有很多服务,每个服务都对应一个端口</p><p>客户端发过来的网络请求, 通过端口号, 可以被准确地交给对应的Web服务进行处理</p><p><strong>端口号就是用来辨别电脑上的端口</strong></p><p>注意</p><ul><li>每个端口号不能同时被多个web应用占用</li><li>在实际应用中 , 如果web服务器的端口号为80 , 则URL中的<strong>80端口可以被省略</strong> , 只有80端口号是可以省略的, 其他不行!!!</li></ul><h3 id="创建最基本的web服务器" tabindex="-1">创建最基本的Web服务器 <a class="header-anchor" href="#创建最基本的web服务器" aria-label="Permalink to &quot;创建最基本的Web服务器&quot;">​</a></h3><h4 id="基本步骤" tabindex="-1">基本步骤 <a class="header-anchor" href="#基本步骤" aria-label="Permalink to &quot;基本步骤&quot;">​</a></h4><ol><li>导入<code>http</code>模块</li><li>创建web服务器实例</li><li>为服务器实例绑定<code>request</code>事件, 监听客户端的请求</li><li>启动服务器</li></ol><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// 1.导入http模块</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> http </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">require</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">http</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 2. 创建web服务器实例</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> server </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> http</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">createServer</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 3. 为服务器实例绑定request事件, 监听客户端请求</span></span>
<span class="line"><span style="color:#A6ACCD;">server</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">on</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">request</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#C792EA;">function</span><span style="color:#89DDFF;">(){</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">.....</span><span style="color:#F07178;">  </span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//4.启动服务器,</span></span>
<span class="line"><span style="color:#A6ACCD;">server</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">listen</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">80</span><span style="color:#89DDFF;">,</span><span style="color:#C792EA;">function</span><span style="color:#89DDFF;">(){</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">.,...</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><h4 id="req请求对象" tabindex="-1">req请求对象 <a class="header-anchor" href="#req请求对象" aria-label="Permalink to &quot;req请求对象&quot;">​</a></h4><p>只要我们服务器接收到了客户端的请求, 就会调用通过<code>server()</code>为服务器绑定的<code>request</code>事件处理函数</p><p>如果想访问客户端相关的数据 或属性</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">server</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">on</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">request</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,(</span><span style="color:#A6ACCD;font-style:italic;">reg</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// req 是请求对象 , 他包含了客户端相关的数据和属性</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// 例如 req.url 表示客户端请求的url地址</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// req.method 是客户端请求类型</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">str</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">`</span><span style="color:#C3E88D;">Your request url is </span><span style="color:#89DDFF;">${</span><span style="color:#A6ACCD;">req</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">url</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;"> , and request method is </span><span style="color:#89DDFF;">${</span><span style="color:#A6ACCD;">req</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">method</span><span style="color:#89DDFF;">}`</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">str</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><h4 id="res响应对象" tabindex="-1">res响应对象 <a class="header-anchor" href="#res响应对象" aria-label="Permalink to &quot;res响应对象&quot;">​</a></h4><p>在服务器的request事件处理函数中 ,如果想访问与服务器相关的数据或属性</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">server</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">on</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">request</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,(</span><span style="color:#A6ACCD;font-style:italic;">reg</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// res是响应对象 ,他包含了服务器相关的数据和属性</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// 例如  ,要发送到客户端的字符串</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//此处的req.url是 URL中端口号后面的部分</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">str</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">`</span><span style="color:#C3E88D;">Your request url is </span><span style="color:#89DDFF;">${</span><span style="color:#A6ACCD;">req</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">url</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;"> , and request method is </span><span style="color:#89DDFF;">${</span><span style="color:#A6ACCD;">req</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">method</span><span style="color:#89DDFF;">}`</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//res.end()方法的作用</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// 向客户端发送指定的内容 , 并结束这次请求的处理</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">end</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">str</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><h4 id="解决中文乱码问题" tabindex="-1">解决中文乱码问题 <a class="header-anchor" href="#解决中文乱码问题" aria-label="Permalink to &quot;解决中文乱码问题&quot;">​</a></h4><p>当调用<code>res.end()</code>方法 ,向客户端发送中文内容的时候, 会出现乱码问题 , 因此需要手动设置内容的编码格式</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">server</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">on</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">request</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,(</span><span style="color:#A6ACCD;font-style:italic;">reg</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//发送的内容中包含中文</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">str</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">您请求的地址是 ${req.url} , 请求的method类型是 ${req.method}</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// 为了防止中文乱码问题 , 需要手动设置响应头的编码格式</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setHeader</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Content-Type</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">text/html; charset=utf-8</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// 把包含中文的内容响应给客户端</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">end</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">str</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><h3 id="根据不同的url响应不同的html内容" tabindex="-1">根据不同的URL响应不同的HTML内容 <a class="header-anchor" href="#根据不同的url响应不同的html内容" aria-label="Permalink to &quot;根据不同的URL响应不同的HTML内容&quot;">​</a></h3><h4 id="核心步骤" tabindex="-1">核心步骤 <a class="header-anchor" href="#核心步骤" aria-label="Permalink to &quot;核心步骤&quot;">​</a></h4><ol><li>获取请求的URL地址</li><li>设置默认的响应内容为 404 Not found</li><li>判断用户请求是否为<code>/</code> 或 <code>/index.html</code>首页</li><li>判断用户请求的是否为<code>/about.html</code>页面</li><li>设置<code>Content-Type</code>响应头 , 防止中文乱码</li><li>使用<code>res.end()</code>把内容响应给客户端, 并结束这次请求</li></ol><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">server</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">on</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">request</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,(</span><span style="color:#A6ACCD;font-style:italic;">req</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#89DDFF;">)</span><span style="color:#C792EA;">=&gt;</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">url</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">req</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">url</span><span style="color:#F07178;"> </span><span style="color:#676E95;font-style:italic;">// 1. 获取请求地址</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">content</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">&lt;h1&gt;404 not found&lt;/h1&gt;</span><span style="color:#89DDFF;">&#39;</span><span style="color:#676E95;font-style:italic;">//2.设置默认的内容</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">url</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">||</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">url</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">index.html</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span><span style="color:#676E95;font-style:italic;">//3如果用户请求的是首页</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">content</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">&lt;h1&gt;首页&lt;/h1&gt;</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">url</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/about.html</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">{</span><span style="color:#676E95;font-style:italic;">//4. 如果用户请求的是关于页面</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">content</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">&lt;h1&gt;关于页面&lt;/h1&gt;</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//5.设置响应头 , 防止中文乱码</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setHeader</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Content-Type</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">text/html; charset=utf-8</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//6.把内容发送给客户端</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">end</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">content</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><h1 id="模块化" tabindex="-1">模块化 <a class="header-anchor" href="#模块化" aria-label="Permalink to &quot;模块化&quot;">​</a></h1><h2 id="模块化的基本概念" tabindex="-1">模块化的基本概念 <a class="header-anchor" href="#模块化的基本概念" aria-label="Permalink to &quot;模块化的基本概念&quot;">​</a></h2><h3 id="什么是模块化" tabindex="-1">什么是模块化 <a class="header-anchor" href="#什么是模块化" aria-label="Permalink to &quot;什么是模块化&quot;">​</a></h3><p>模块化是指解决一个复杂问题时 , 自顶向下 逐层把系统划分成若干模块的过程 , 对于整个系统来说,模块是可组合,分解和更换的单元</p><p><strong>编程中的模块化</strong></p><p>遵守固定的规则, 把一个大文件 拆分成独立并互相依赖的多个小模块</p><p>优点</p><ul><li>提高了代码的重用性</li><li>提高了代码的可维护性</li><li>可以实现按需加载</li></ul><h3 id="模块化规范" tabindex="-1">模块化规范 <a class="header-anchor" href="#模块化规范" aria-label="Permalink to &quot;模块化规范&quot;">​</a></h3><p><strong>模块化规范</strong>就是对代码进行模块化拆分与组合时, 需要遵守的那些规则</p><p>例如</p><ul><li>使用什么样的语法格式来<strong>引用模块</strong></li><li>在模块中使用什么样的语法格式<strong>向外暴露成员</strong></li></ul><p>**模块化规范的好处: ** 大家都遵守同样的模块化规范写代码 , 降低了沟通的成本 ,极大方便了各个模块之间的相互调用</p><h2 id="node-js中的模块化" tabindex="-1">Node.js中的模块化 <a class="header-anchor" href="#node-js中的模块化" aria-label="Permalink to &quot;Node.js中的模块化&quot;">​</a></h2><h3 id="node-js中模块的分类" tabindex="-1">Node.js中模块的分类 <a class="header-anchor" href="#node-js中模块的分类" aria-label="Permalink to &quot;Node.js中模块的分类&quot;">​</a></h3><p>Node.js中根据模块的来源不同 , 将模块分为了3大类</p><ul><li><strong>内置模块</strong> 由Node.js官方提供的 , 例如 fs , path , http等,在安装Node.js时就已经将这些模块安装到本地了</li><li><strong>自定义模块</strong> <strong>用户创建的每个.js文件, 都是自定义模块 ;</strong></li><li><strong>第三方模块</strong> 第三方开发出来的模板 , 并非官方提供的内置模板 , 也不是用户创建的自定义模板,使用前需要先下载</li></ul><h3 id="加载模块" tabindex="-1">加载模块 <a class="header-anchor" href="#加载模块" aria-label="Permalink to &quot;加载模块&quot;">​</a></h3><p>使用强大的<code>require()</code>方法,可以加载需要的<strong>内置模块,,用户自定义模块, 第三方模块</strong>进行使用</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// 1. 加载内置模块</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> fs </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">require</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">fs</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//2. 加载用户自定义模块</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 给出本地路径</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> custom </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">require</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./custom.js</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//3.加载第三方模块</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> moment </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">require</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">moment</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><p><strong>注意</strong> : 当使用<code>require()</code>方法加载其他模块时, 会执行被加载模块中的代码</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> custom </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">require</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./myModule.js</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//在加载用户自定义模块时, 可以省略.js后缀名</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//效果相同</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> custom </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">require</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./myModule</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#A6ACCD;">(custom)</span></span></code></pre></div><h3 id="node-js中的模块作用域" tabindex="-1">Node.js中的模块作用域 <a class="header-anchor" href="#node-js中的模块作用域" aria-label="Permalink to &quot;Node.js中的模块作用域&quot;">​</a></h3><h4 id="什么是模块作用域" tabindex="-1">什么是模块作用域 <a class="header-anchor" href="#什么是模块作用域" aria-label="Permalink to &quot;什么是模块作用域&quot;">​</a></h4><p>和<strong>函数作用域</strong> 类似, <strong>在自定义模块中定义的变量 , 方法等成员 , 只能在当前的模块中访问</strong> , 这种模块级别的访问限制,叫做模块的作用域</p><h4 id="模块作用域的好处" tabindex="-1">模块作用域的好处 <a class="header-anchor" href="#模块作用域的好处" aria-label="Permalink to &quot;模块作用域的好处&quot;">​</a></h4><p><strong>防止 了全局变量污染的问题</strong></p><p>例如:</p><blockquote><p>在浏览器中, 没有模块作用域的概念</p><p>我导入first.js 模块, 里面的username=&quot;张三&quot;;</p><p>然后我又导入second.js模块,里面有username=&quot;李四&quot;</p><p>这时候,我打印console.log(username) 结果为&quot;李四&quot; ,</p><p>first.js中的username被污染</p></blockquote><h3 id="向外共享模块作用域中的成员" tabindex="-1">向外共享模块作用域中的成员 <a class="header-anchor" href="#向外共享模块作用域中的成员" aria-label="Permalink to &quot;向外共享模块作用域中的成员&quot;">​</a></h3><h4 id="module对象" tabindex="-1">module对象 <a class="header-anchor" href="#module对象" aria-label="Permalink to &quot;module对象&quot;">​</a></h4><p>在每一个.js自定义模块中都有一个module对象, 他存储了当前模块有关的信息</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">module</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">/*</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">Module {</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">  id: &#39;.&#39;,</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">  path: &#39;D:\\test\\node&#39;,</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">  exports: {},</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">  filename: &#39;D:\\test\\node\\myModule.js&#39;,</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">  loaded: false,</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">  children: [],</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">  paths: [</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">    &#39;D:\\test\\node\\node_modules&#39;,</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">    &#39;D:\\test\\node_modules&#39;,</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">    &#39;D:\\node_modules&#39;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">  ]</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">}</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">*/</span></span></code></pre></div><h4 id="module-exports-对象" tabindex="-1">module.exports 对象 <a class="header-anchor" href="#module-exports-对象" aria-label="Permalink to &quot;module.exports 对象&quot;">​</a></h4><p><strong>在自定义模块中, 可以使用<code>module.exports</code>对象,将模块内的成员分享出去, 供外界使用</strong></p><p><strong>外界使用<code>requir()</code>方法导入自定义模块时, 得到的就是<code>module.exports</code>所指的对象</strong></p><p>在一个自定义模块中, <code>module.exports</code>默认为空</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// 当前文件就是用户自定义模块</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> username </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">张三</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">sayHello</span><span style="color:#89DDFF;">(){</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">`</span><span style="color:#C3E88D;">大家好,我是</span><span style="color:#89DDFF;">${</span><span style="color:#A6ACCD;">username</span><span style="color:#89DDFF;">}`</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> age </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">20</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// console.log(module)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 向module.exports对象上挂载属性</span></span>
<span class="line"><span style="color:#89DDFF;">module.exports.</span><span style="color:#A6ACCD;">username</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">赵6</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;">module.exports.</span><span style="color:#82AAFF;">myfunction</span><span style="color:#89DDFF;">=</span><span style="color:#C792EA;">function</span><span style="color:#89DDFF;">(){</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">我是傻逼</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">module.exports.</span><span style="color:#A6ACCD;">sayHello</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">sayHello</span></span>
<span class="line"><span style="color:#89DDFF;">module.exports.</span><span style="color:#A6ACCD;">age</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">age</span></span></code></pre></div><p><strong>注意点</strong> : 使用<code>require()</code> 方法导入模块时, 永远以<code>module.exports</code>指向的最后一个对象为准</p><h4 id="exports对象" tabindex="-1">exports对象 <a class="header-anchor" href="#exports对象" aria-label="Permalink to &quot;exports对象&quot;">​</a></h4><p>由于<code>module.exports</code>单词写起来比较复杂, 为了简化共享成员的代码,Node提供了<code>exports</code>对象,默认情况下 , <code>exports</code>和<code>module.exports</code>指向同一个对象 , 最终的共享结果 , 还是以<code>module.exports</code>指向的对象为准</p><p>只不过<code>exports</code>写起来更加方便</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">exports</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">===</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">module.exports</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//结果为true</span></span></code></pre></div><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> username </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">张三</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;">exports.</span><span style="color:#A6ACCD;">username </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> username</span></span>
<span class="line"><span style="color:#89DDFF;">exports.</span><span style="color:#82AAFF;">sayHello</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#89DDFF;">(){</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">大家好</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><h4 id="exports和module-exports使用误区" tabindex="-1">exports和module.exports使用误区 <a class="header-anchor" href="#exports和module-exports使用误区" aria-label="Permalink to &quot;exports和module.exports使用误区&quot;">​</a></h4><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">exports.</span><span style="color:#A6ACCD;">username</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">张三</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;">module.exports</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">={</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">gender</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">boy</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">age </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">22</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//在另一个模块中,导入该模块</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> m </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">require</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#A6ACCD;">(m)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//结果为</span></span>
<span class="line"><span style="color:#89DDFF;">{</span><span style="color:#FFCB6B;">gender</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">boy</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#FFCB6B;">age</span><span style="color:#89DDFF;">:</span><span style="color:#F78C6C;">22</span><span style="color:#89DDFF;">}</span></span></code></pre></div><p>原理: 原来<code>exports</code>和<code>module.exports</code>指向同一个对象 , 然后又在内存中开辟了一个新的对象, 让<code>module.exports</code>对象指向这个新对象 , 由于<code>require()</code>导入的最终结果以<code>module.exports</code>为准, 所以就会出现这种情况</p><p><img src="https://kkbank.oss-cn-qingdao.aliyuncs.com/note-img/image-20220426120723396.png" alt="image-20220426120723396"></p><p><img src="https://kkbank.oss-cn-qingdao.aliyuncs.com/note-img/image-20220426121127924.png" alt="image-20220426121127924"></p><p><strong>注意</strong> : 为了防止混乱, 建议大家不要在同一个模块中同时使用<code>exports</code>和<code>module.exports</code></p><h3 id="commonjs-规范" tabindex="-1">CommonJS 规范 <a class="header-anchor" href="#commonjs-规范" aria-label="Permalink to &quot;CommonJS 规范&quot;">​</a></h3><p>Node.js 遵循了 CommonJS 模块化规范，CommonJS 规定了<strong>模块的特性和各模块之间如何相互依赖。</strong></p><p>CommonJS规定</p><ul><li>每个模块内部 , <strong>module变量</strong> 代表当前模块</li><li><strong>module</strong> 变量是一个对象 , 他的<strong>exports</strong> 属性(即 module.exports) 是对外接口</li><li>加载整个模块 , 其实就是加载该模块的<code>module.exports</code>属性 , <code>require()</code>用于加载模块</li></ul><h2 id="npm与包" tabindex="-1">npm与包 <a class="header-anchor" href="#npm与包" aria-label="Permalink to &quot;npm与包&quot;">​</a></h2><h3 id="包" tabindex="-1">包 <a class="header-anchor" href="#包" aria-label="Permalink to &quot;包&quot;">​</a></h3><p>Node.js中的<strong>第三方模块</strong> 又叫做 <strong>包</strong></p><p>不同于Node.js中的内置模块与自定义模块 , <strong>包由第三方个人或者团队开发出来</strong>, 免费提供给所有人使用</p><p><strong>注意</strong>: Node.js中的包都是免费且开源的 , 不需要付费即可免费下载使用</p><h4 id="如何下载包" tabindex="-1">如何下载包 <a class="header-anchor" href="#如何下载包" aria-label="Permalink to &quot;如何下载包&quot;">​</a></h4><p>国外有一家 IT 公司，叫做 <strong>npm, Inc.</strong> 这家公司旗下有一个非常著名的网站： <a href="https://www.npmjs.com/" target="_blank" rel="noreferrer">https://www.npmjs.com/</a> ，它是<strong>全球最大的包共享平台</strong>，你可以从这个网站上搜索到任何你需要的包.</p><p><strong>npm, Inc.</strong> <strong>公司</strong>提供了一个地址为 <a href="https://registry.npmjs.org/" target="_blank" rel="noreferrer">https://registry.npmjs.org/</a> 的服务器，来对外共享所有的包，我们可以从这个服务器上下载自己所需要的包。</p><p><strong>注意：</strong></p><ul><li>从 <a href="https://www.npmjs.com/" target="_blank" rel="noreferrer">https://www.npmjs.com/</a> 网站上搜索自己所需要的包</li><li>从 <a href="https://registry.npmjs.org/" target="_blank" rel="noreferrer">https://registry.npmjs.org/</a> 服务器上下载自己需要的包</li></ul><p><strong>npm, Inc.</strong> <strong>公司</strong>提供了一个包管理工具，我们可以使用这个包管理工具，从 <a href="https://registry.npmjs.org/" target="_blank" rel="noreferrer">https://registry.npmjs.org/</a> 服务器把需要的包下载到本地使用。</p><p>这个包管理工具的名字叫做 Node Package Manager（简称 npm 包管理工具），这个包管理工具随着 Node.js 的安装包一起被安装到了用户的电脑上。</p><p>大家可以在终端中执行 <strong>npm -v</strong> 命令，来查看自己电脑上所安装的 npm 包管理工具的版本号：</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">npm </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">v</span></span></code></pre></div><p>当我们需要安装某个包时,执行这条命令即可</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">npm install 包名</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">可以简写为</span></span>
<span class="line"><span style="color:#A6ACCD;">npm i 包名</span></span></code></pre></div><p>当然我们也可以安装指定版本的包</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">npm i 包名@版本号</span></span>
<span class="line"><span style="color:#A6ACCD;">例如</span></span>
<span class="line"><span style="color:#A6ACCD;">npm i moment@</span><span style="color:#F78C6C;">2.22</span><span style="color:#89DDFF;">.</span><span style="color:#F78C6C;">2</span></span></code></pre></div><h3 id="初次下载" tabindex="-1">初次下载 <a class="header-anchor" href="#初次下载" aria-label="Permalink to &quot;初次下载&quot;">​</a></h3><p>初次下载完包之后, 在项目文件夹下多了一个叫做<code>node_modules</code>的文件夹和<code>package-lock.json</code>的配置文件</p><ul><li><code>node_modules</code>文件夹用来存放已安装项目中的包 , <code>require()</code>导入第三方包时, 就是从这个目录中查找并加载包</li><li><code>package-lock.json</code>配置文件用来记录<code>node_modules</code>目录下的每一个包的下载信息,例如包的名字 , 版本号 ,下载地址等</li></ul><p><strong>注意</strong> : 我们不要手动修改<code>node_modules</code>或<code>package-lock.json</code>文件中的代码 , npm包管理器会自动去维护他们</p><h3 id="包管理配置文件" tabindex="-1">包管理配置文件 <a class="header-anchor" href="#包管理配置文件" aria-label="Permalink to &quot;包管理配置文件&quot;">​</a></h3><p>npm规定 , 在项目根目录中 , 必须提供一个<code>package.json</code>的包管理配置文件 , 用来记录与项目有关的一些配置文件, 例如</p><ul><li>项目的名称 , 版本号 , 描述等</li><li>项目中都用到了那些包</li><li>哪些包只在开发期间用</li><li>哪些包在开发和部署时都需要用到</li></ul><h4 id="多人协作问题" tabindex="-1">多人协作问题 <a class="header-anchor" href="#多人协作问题" aria-label="Permalink to &quot;多人协作问题&quot;">​</a></h4><blockquote><p>例如 , 我们需要多人协作时 ,通常将项目上传到Github上,但是有一个问题:</p><p>整个项目体积30M , 第三方包体积是 28M , 源代码只有2M</p><p>第三方包的体积过大 , 不方便上传和下载</p></blockquote><p><strong>解决方案就是: 共享时剔除<code>node_modules</code>文件夹</strong> , 别人下载源代码后 , 只需要在本地安装包即可</p><h4 id="记录项目中安装了哪些包" tabindex="-1">记录项目中安装了哪些包 <a class="header-anchor" href="#记录项目中安装了哪些包" aria-label="Permalink to &quot;记录项目中安装了哪些包&quot;">​</a></h4><p>我们剔除了<code>node_modules</code>文件夹 , 怎么知道项目中用到了哪些包呢?</p><p><strong>在项目根目录下,创建一个叫做<code>package.json</code>的配置文件 , 即可用来记录项目中用到了哪些包</strong></p><h4 id="快速创建pack-json" tabindex="-1">快速创建pack.json <a class="header-anchor" href="#快速创建pack-json" aria-label="Permalink to &quot;快速创建pack.json&quot;">​</a></h4><p>npm包管理工具提供了一个快捷命令 , 可以在执行命令所处的目录中 , 快速创建package.json这个包管理配置文件</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">在执行命令所处的根目录中</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> 快速新建 package</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">json文件</span></span>
<span class="line"><span style="color:#A6ACCD;">npm init </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">y</span></span></code></pre></div><p>注意</p><ul><li>上述命令只能在<strong>英文目录下成功运行</strong> , 所以项目文件夹的名称 一定要使用英文命令 ,<strong>不要使用中文,不能出现空格</strong></li><li>运行<code>npm install 包</code> 安装包时, npm包管理工具会自动<strong>包的名称</strong>和<strong>版本号</strong> , 记录到<code>package.json</code>中</li></ul><h4 id="dependencies节点" tabindex="-1">dependencies节点 <a class="header-anchor" href="#dependencies节点" aria-label="Permalink to &quot;dependencies节点&quot;">​</a></h4><p><code>package.json</code>文件中 , 有一个<code>dependencies</code>节点 , 专门用来记录<code>npm install</code>命令安装了哪些包</p><p><img src="https://kkbank.oss-cn-qingdao.aliyuncs.com/note-img/image-20220426183221504.png" alt="image-20220426183221504"></p><h4 id="一次性安装所有的包" tabindex="-1">一次性安装所有的包 <a class="header-anchor" href="#一次性安装所有的包" aria-label="Permalink to &quot;一次性安装所有的包&quot;">​</a></h4><p>当我们拿到一个剔除了<code>node_modules</code>的项目后 , 需要先把所有的包下载到文件中 ,才能将项目运行起来否则会报错</p><p><img src="https://kkbank.oss-cn-qingdao.aliyuncs.com/note-img/image-20220426183331101.png" alt="image-20220426183331101"></p><p>可以通过命令把这个项目中要用到的包一次性安装下来</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">npm install</span></span>
<span class="line"><span style="color:#A6ACCD;">或 简写</span></span>
<span class="line"><span style="color:#A6ACCD;">npm i</span></span></code></pre></div><p>执行此命令时 , npm包管理工具会先读取<code>package.json</code>中的<code>dependencies</code>节点, 读取到所有依赖包的名称和版本号后,npm包管理工具把这些包一次性下载到项目中</p><h4 id="卸载包" tabindex="-1">卸载包 <a class="header-anchor" href="#卸载包" aria-label="Permalink to &quot;卸载包&quot;">​</a></h4><p>可以运行指定的命令 , 来卸载指定的包</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">npm uninstall 包名</span></span>
<span class="line"><span style="color:#A6ACCD;">例如</span></span>
<span class="line"><span style="color:#A6ACCD;">npm uninstall moment</span></span></code></pre></div><p><strong>注意</strong> : <code>npm uninstall </code>命令执行成功后 , 会把卸载的包 ,从<code>package.json</code>中的<code>dependencies</code>中移除掉</p><h4 id="devdependencies节点" tabindex="-1">devDependencies节点 <a class="header-anchor" href="#devdependencies节点" aria-label="Permalink to &quot;devDependencies节点&quot;">​</a></h4><p>如果某些包只在项目开发阶段会用到 , 在项目上线后不会用到 , 则建议把这些包记录到<code>devDependencies</code>节点中 , 例如 <code>webpack</code>工具 , 与之对应的 , 如果某些包在项目开发和上线后都需要用到 , 则建议把这些包记录到<code>dependencies</code>节点中</p><p>可以执行如下命令 , 将包记录到<code>devDependencies</code>节点中</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">npm install 包名 </span><span style="color:#89DDFF;">--</span><span style="color:#A6ACCD;">save</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">dev</span></span>
<span class="line"><span style="color:#A6ACCD;">或简写为</span></span>
<span class="line"><span style="color:#A6ACCD;">npm i 包名 </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">D</span></span></code></pre></div><h3 id="包下载慢的问题" tabindex="-1">包下载慢的问题 <a class="header-anchor" href="#包下载慢的问题" aria-label="Permalink to &quot;包下载慢的问题&quot;">​</a></h3><p>在使用npm包管理工具下载的时候 , 默认从国外的的 <a href="https://registry.npmjs.org/" target="_blank" rel="noreferrer">https://registry.npmjs.org/</a> 服务器进行下载,,所以会很慢</p><p>我们可以修改npm的下载路径 , 使其从国内的镜像服务器上下载 , 这样就解决了包下载慢的问题</p><p>我们可以从<strong>淘宝NPM镜像服务器</strong> 上下载 , 淘宝的镜像服务器每隔一段时间会自动把npm服务器的包同步到自己的服务器上 , 对国内用于提供下载服务</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">//查看当前的下载包路径</span></span>
<span class="line"><span style="color:#A6ACCD;">npm config get registry</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//默认为https://registry.npmjs.org/</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//将包下载路径切换为淘宝镜像服务器</span></span>
<span class="line"><span style="color:#A6ACCD;">npm config set registry</span><span style="color:#89DDFF;">=</span><span style="color:#FFCB6B;">https</span><span style="color:#89DDFF;">:</span><span style="color:#676E95;font-style:italic;">//registry.npm.taobao.org/</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//检查镜像源是否修改成成功</span></span>
<span class="line"><span style="color:#A6ACCD;">npm config get registry</span></span></code></pre></div><h4 id="nrm" tabindex="-1">nrm <a class="header-anchor" href="#nrm" aria-label="Permalink to &quot;nrm&quot;">​</a></h4><p>当我们使用上面的命令来切换npm下载镜像源 时 , 非常麻烦 , 我们可以使用一个小工具<code>nrm</code></p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">//将nrm 安装为全局可用的工具</span></span>
<span class="line"><span style="color:#A6ACCD;">npm i nrm </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">g</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//查看所有的镜像源</span></span>
<span class="line"><span style="color:#A6ACCD;">nrm ls</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//将下载包的镜像源切换为tabo</span></span>
<span class="line"><span style="color:#A6ACCD;">nrm use taobao</span></span></code></pre></div><p><img src="https://kkbank.oss-cn-qingdao.aliyuncs.com/note-img/image-20220426190523893.png" alt="image-20220426190523893"></p><h3 id="包的分类" tabindex="-1">包的分类 <a class="header-anchor" href="#包的分类" aria-label="Permalink to &quot;包的分类&quot;">​</a></h3><p>使用npm包管理工具下载的包 , 共分为 两大类</p><ul><li>项目包</li><li>全局包</li></ul><h4 id="项目包" tabindex="-1">项目包 <a class="header-anchor" href="#项目包" aria-label="Permalink to &quot;项目包&quot;">​</a></h4><p>那些被安装到项目的<code>node_modules</code>目录中的包 ,都是<strong>项目包</strong></p><p>项目包又分为两类</p><ul><li><strong>开发依赖包</strong> , 被记录到<code>devDependencies</code>节点中的包 , 只在开发期间会用到</li><li><strong>核心依赖包</strong> , 被记录到<code>dependencies</code>节点中的包 , 在开发和项目上线之后都会用到</li></ul><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">npm i 包名 </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">D 安装开发依赖包</span></span>
<span class="line"><span style="color:#A6ACCD;">npm i 包名  核心依赖包</span></span></code></pre></div><h4 id="全局包" tabindex="-1">全局包 <a class="header-anchor" href="#全局包" aria-label="Permalink to &quot;全局包&quot;">​</a></h4><p>在执行<code>npm install </code>命令时 , 如果提供了<code>-g </code>参数 ,则会把包安装为<strong>全局包</strong></p><p>全局包默认会被安装到<code>C:\Users\用户目录\AppData\Roaming\npm\node_modules</code>目录下</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">npm i 包名 </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">g 全局安装的包</span></span>
<span class="line"><span style="color:#A6ACCD;">npm uninstall 包名 </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">g   卸载全局包</span></span></code></pre></div><p><strong>注意</strong></p><ul><li>只有工具性质的包 , 才有全局安装的必要性 ,因为他们提供了好用的终端命令</li><li>判断某个包是否需要全局安装才能使用 , 可以参考官方提供的使用说明</li></ul><h4 id="i5ting-toc" tabindex="-1">i5ting_toc <a class="header-anchor" href="#i5ting-toc" aria-label="Permalink to &quot;i5ting_toc&quot;">​</a></h4><p>推荐一个好用的小工具</p><p><code>i5ting_toc</code>是一个可以把md文档转换为html页面的小工具</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">//将i5ting_toc安装为全局包</span></span>
<span class="line"><span style="color:#A6ACCD;">npm install </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">g i5ting_toc</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//调用i5ting_toc , 轻松实现 md 转 html 的功能</span></span>
<span class="line"><span style="color:#A6ACCD;">i5ting_toc </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">f 要转换的md文件路径 </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">o</span></span></code></pre></div><h3 id="包的规范" tabindex="-1">包的规范 <a class="header-anchor" href="#包的规范" aria-label="Permalink to &quot;包的规范&quot;">​</a></h3><p>深入了解一下包的结构</p><p>一个规范 的包, 他的组成结构,必须符合以下3点要求</p><ul><li>包必须以<strong>单独的目录</strong> 而存在</li><li>包的顶级目录下要必须包含<strong>package.json</strong>这个包管理配置文件</li><li><code>package.json</code>中必须包含<code>name</code> , <code>version</code> , <code>main</code> 这三个属性 ,分别代表<strong>包的名字,版本号 ,包的入口</strong></li><li><code>main</code>属性用来指明包的入口文件, 即<code>require()</code>需要引入的真正对象</li></ul><h2 id="模块加载机制" tabindex="-1">模块加载机制 <a class="header-anchor" href="#模块加载机制" aria-label="Permalink to &quot;模块加载机制&quot;">​</a></h2><h4 id="优先从缓存中加载" tabindex="-1">优先从缓存中加载 <a class="header-anchor" href="#优先从缓存中加载" aria-label="Permalink to &quot;优先从缓存中加载&quot;">​</a></h4><p><strong>模块在第一次加载后会被缓存</strong> , 这也就意味着多次调用<code>require()</code>引入统一模块不会导致模块内的代码被执行多次</p><p><strong>注意</strong> : 不论是内置模块 , 用户自定义模块 , 还是第三方模块 ,他们都会优先从缓存中加载 , <strong>从而提供模块的加载效率</strong></p><h4 id="内置模块的加载机制" tabindex="-1">内置模块的加载机制 <a class="header-anchor" href="#内置模块的加载机制" aria-label="Permalink to &quot;内置模块的加载机制&quot;">​</a></h4><p>内置模块是由Node.js官方提供的模块 , <strong>内置模块的加载优先级最高</strong></p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">例如在node_moudles目录下有一个我自己创建的 fs模块</span></span>
<span class="line"><span style="color:#A6ACCD;">我现在引入 fs模块</span></span>
<span class="line"><span style="color:#82AAFF;">require</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">fs</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">实际引入的是系统内置模块的fs</span></span></code></pre></div><h4 id="自定义模块的加载机制" tabindex="-1">自定义模块的加载机制 <a class="header-anchor" href="#自定义模块的加载机制" aria-label="Permalink to &quot;自定义模块的加载机制&quot;">​</a></h4><p>使用<code>require()</code> 加载自定义模块时 , <strong>必须指定<code>./</code>或<code>../</code>开头的 路径标识符</strong> , 如果没有指定<code>./</code>或<code>../</code>这样的路径标识符 , 则运行时会把他当做<strong>内置模块</strong> 或<strong>第三方模块</strong>进行加载</p><p>我们知道 , 在导入自定义模块时, 是可以省略<code>.js</code>后缀名的 , 其实真正的原理是这样的</p><ol><li>按照确切的文件名进行加载</li><li>如果上一步 行不通 , 则 补全 <code>.js</code>拓展名进行加载</li><li>如果上一步行不通 , 则补全<code>.json</code>拓展名进行加载</li><li>如果上一步行不通 , 则补全<code>.node</code>拓展名进行加载</li><li>最终还是不行 , 则加载失败 , 报错</li></ol><h4 id="第三方模块的加载机制" tabindex="-1">第三方模块的加载机制 <a class="header-anchor" href="#第三方模块的加载机制" aria-label="Permalink to &quot;第三方模块的加载机制&quot;">​</a></h4><p>如果传递给<code>require()</code>的不是一个内置模块 , 也不是<code>./</code>或<code>../</code>开头的标识符, 则系统会判定为第三方模块 , 尝试从 <code>/node_modules</code>文件夹中加载第三方模块</p><p>如果在当前项目的<code>node_modules</code>文件夹中没有找到该模块 , 则开始逐层向上寻找 , 直到文件系统的根目录</p><p><img src="https://kkbank.oss-cn-qingdao.aliyuncs.com/note-img/image-20220427185033245.png" alt="image-20220427185033245"></p><h4 id="目录作为模块" tabindex="-1">目录作为模块 <a class="header-anchor" href="#目录作为模块" aria-label="Permalink to &quot;目录作为模块&quot;">​</a></h4><p>当我们给<code>require()</code> 传递的标识符是一个目录时 , 系统也会去加载 , 有三种加载方式</p><ul><li>在被加载目录下查找一个叫做<code>package.json</code>的文件 , 并寻找<code>main</code>属性 , 作为<code>require()</code>加载的入口</li><li>如果在目录中没有<code>package.json</code>文件, 或者<code>main</code>入口不存在或无法解析 , 则Node.js将会视图加载目录下的<code>index.js</code>文件</li><li>如果上两步都失败了 , 则Node.js会报错</li></ul><h2 id="开发属于自己的包" tabindex="-1">开发属于自己的包 <a class="header-anchor" href="#开发属于自己的包" aria-label="Permalink to &quot;开发属于自己的包&quot;">​</a></h2><ol><li><p>新建一个项目文件夹 , 作为包的根目录</p></li><li><p>在包的根目录下 , 创建如下三个文件</p><ul><li><code>package.json</code> 包管理配置文件</li><li><code>index.js</code> 包的入口文件</li><li><code>README.md</code> 包的说明文档</li></ul></li><li><p>初始化<code>package.json</code>配置文件 , 必须包含以下几个属性,不能少</p><p><img src="https://kkbank.oss-cn-qingdao.aliyuncs.com/note-img/image-20220427185615214.png" alt="image-20220427185615214"></p></li><li><p>编写<code>README.md</code>包的说明文档, 包括: <strong>包的安装方式 , 导入方式 , 包内的方法和属性的使用说明 ,开源协议</strong></p></li></ol><h3 id="发布包" tabindex="-1">发布包 <a class="header-anchor" href="#发布包" aria-label="Permalink to &quot;发布包&quot;">​</a></h3><ol><li><p>注册<code>npm</code>账号</p></li><li><p>在终端登录<code>npm</code>账号(在运行<code>npm login</code>命令之前, 必须保证包的下载地址为官方 , 可以使用<code>nrm</code>修改下载地址,可以看前面的修改下载地址的文字)</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">//执行</span></span>
<span class="line"><span style="color:#A6ACCD;">npm login</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//然后依次输入账户名和密码即可</span></span></code></pre></div></li><li><p><code>cd</code>到包的根目录下 , 运行<code>npm publish</code>命令 , 即可发布到npm官网上 (注意: 包名不能雷同 , 可以去官网去搜索有没有同名的包)</p></li><li><p><strong>发布包的时候要慎重 , 尽量不要去发布没有意义的包</strong></p></li></ol><h4 id="删除已发布的包" tabindex="-1">删除已发布的包 <a class="header-anchor" href="#删除已发布的包" aria-label="Permalink to &quot;删除已发布的包&quot;">​</a></h4><p>在终端命令行登录后</p><p>运行命令<code>npm unpublish 包名 --force</code> , 即可删除已发布的包</p><p>注意:</p><ul><li><code>npm unpublish</code>命令只能删除<strong>72小时以内发布的包</strong></li><li><code>npm unpublish</code>删除的包 , <strong>在24小时内不允许再次发布</strong></li></ul><h1 id="expreses" tabindex="-1">Expreses <a class="header-anchor" href="#expreses" aria-label="Permalink to &quot;Expreses&quot;">​</a></h1><h2 id="初始express" tabindex="-1">初始Express <a class="header-anchor" href="#初始express" aria-label="Permalink to &quot;初始Express&quot;">​</a></h2><h3 id="express简介" tabindex="-1">Express简介 <a class="header-anchor" href="#express简介" aria-label="Permalink to &quot;Express简介&quot;">​</a></h3><h4 id="什么是express" tabindex="-1">什么是Express <a class="header-anchor" href="#什么是express" aria-label="Permalink to &quot;什么是Express&quot;">​</a></h4><p>官方给出的概念：Express 是基于 Node.js 平台，快速、开放、极简的 Web 开发框架。</p><p>通俗的理解：Express 的作用和 Node.js 内置的 http 模块类似，<strong>是专门用来创建 Web 服务器的。</strong></p><p><strong>Express</strong> <strong>的本质</strong>：就是一个 npm 上的第三方包，提供了快速创建 Web 服务器的便捷方法。</p><p>Express 的中文官网：<a href="http://www.expressjs.com.cn/" target="_blank" rel="noreferrer"> http://www.expressjs.com.cn/</a></p><h4 id="进一步了解express" tabindex="-1">进一步了解Express <a class="header-anchor" href="#进一步了解express" aria-label="Permalink to &quot;进一步了解Express&quot;">​</a></h4><p><img src="https://kkbank.oss-cn-qingdao.aliyuncs.com/note-img/image-20220427192949078.png" alt="image-20220427192949078"></p><h4 id="express能做什么" tabindex="-1">Express能做什么 <a class="header-anchor" href="#express能做什么" aria-label="Permalink to &quot;Express能做什么&quot;">​</a></h4><p>对于前端程序员来说 , 最常见的两种服务器 , 分别是</p><ul><li><strong>Web网站服务器</strong> : 专门对外提供Web网页资源的服务器</li><li><strong>API接口服务器</strong> : 专门对外提供API的接口服务器</li></ul><p>使用Express , 我们可以方便快捷地创建以上的这两种服务器</p><h3 id="express的基本使用" tabindex="-1">Express的基本使用 <a class="header-anchor" href="#express的基本使用" aria-label="Permalink to &quot;Express的基本使用&quot;">​</a></h3><h4 id="安装" tabindex="-1">安装 <a class="header-anchor" href="#安装" aria-label="Permalink to &quot;安装&quot;">​</a></h4><p>在项目所处的目录中 , 运行命令 , 即可将Express安装到项目中使用</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">npm i express</span></span>
<span class="line"><span style="color:#A6ACCD;">在黑马程序员的课程中 推荐安装的是4</span><span style="color:#89DDFF;">.</span><span style="color:#F78C6C;">17.1</span></span>
<span class="line"><span style="color:#A6ACCD;">npm i exprss@</span><span style="color:#F78C6C;">4.17</span><span style="color:#89DDFF;">.</span><span style="color:#F78C6C;">1</span></span></code></pre></div><blockquote><p>从Express官方的历史版本可以看出</p><p>4.17.1版本发布将近3年后, 才出现了4.17.2版本</p><p>说明4.17.1是这段时间最稳的,也是安装最多的</p></blockquote><h4 id="创建基本的web服务器" tabindex="-1">创建基本的Web服务器 <a class="header-anchor" href="#创建基本的web服务器" aria-label="Permalink to &quot;创建基本的Web服务器&quot;">​</a></h4><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">//1.导入Express</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> express </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">require</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">express</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//2.创建web服务器</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> app </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">express</span><span style="color:#A6ACCD;">()</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//3.启动web服务器</span></span>
<span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">listen</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">80</span><span style="color:#89DDFF;">,()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">express server running at http://127.0.0.1</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><h4 id="监听get请求" tabindex="-1">监听GET请求 <a class="header-anchor" href="#监听get请求" aria-label="Permalink to &quot;监听GET请求&quot;">​</a></h4><p>通过<code>app.get()</code>方法 , 可以监听客户端的GET请求</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> express </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">require</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">express</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//创建web服务器</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> app </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">express</span><span style="color:#A6ACCD;">()</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//监听GET请求</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">/*</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">参数1 : 请求的URL地址</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">参数2 : 请求对应的处理函数</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">        req 请求对象 </span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">        res 响应对象</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">*/</span></span>
<span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/user</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,(</span><span style="color:#A6ACCD;font-style:italic;">req</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">send</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">zs</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;">age</span><span style="color:#89DDFF;">:</span><span style="color:#F78C6C;">20</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;">gender</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">boy</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//启动web服务器</span></span>
<span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">listen</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">80</span><span style="color:#89DDFF;">,()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">express server running at http://127.0.0.1</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><h4 id="监听post请求" tabindex="-1">监听POST请求 <a class="header-anchor" href="#监听post请求" aria-label="Permalink to &quot;监听POST请求&quot;">​</a></h4><p>通过<code>app.post()</code>方法 , 可以监听客户端的POST请求</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">//监听POST请求</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">/*</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">参数和上面一样</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">*/</span></span>
<span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">post</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/user</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,(</span><span style="color:#A6ACCD;font-style:italic;">req</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#89DDFF;">)</span><span style="color:#C792EA;">=&gt;</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">send</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">请求成功</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><h4 id="把内容响应给客户端" tabindex="-1">把内容响应给客户端 <a class="header-anchor" href="#把内容响应给客户端" aria-label="Permalink to &quot;把内容响应给客户端&quot;">​</a></h4><p>通过 <code>res.send()</code>方法,可以把处理好的内容, 发送给客户端</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/user</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,(</span><span style="color:#A6ACCD;font-style:italic;">req</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">send</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">zs</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;">age</span><span style="color:#89DDFF;">:</span><span style="color:#F78C6C;">20</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;">gender</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">boy</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">post</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/user</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,(</span><span style="color:#A6ACCD;font-style:italic;">req</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#89DDFF;">)</span><span style="color:#C792EA;">=&gt;</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">send</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">请求成功</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><h4 id="获取url中携带的查询参数" tabindex="-1">获取URL中携带的查询参数 <a class="header-anchor" href="#获取url中携带的查询参数" aria-label="Permalink to &quot;获取URL中携带的查询参数&quot;">​</a></h4><p>通过<code>req.query</code> 对象 , 可以访问到客户端通过查询字符串的形式,发送到服务器的参数,拿到这些参数后, 会把参数解析到<code>req.query</code>对象身上</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,(</span><span style="color:#A6ACCD;font-style:italic;">req</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#89DDFF;">)</span><span style="color:#C792EA;">=&gt;</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//req.query 默认是一个空对象</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//客户端使用 ?name=za&amp;age=20这种查询字符串形式,发送到服务器端的参数</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//可以通过req.query 对象访问到,例如</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//req.query.name      req.query.age</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">req</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">query</span><span style="color:#F07178;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><p>此时我们访问<code>http:localhost/?name=&#39;zs&#39;&amp;id=5</code> , 就会看到请求的信息</p><h4 id="获取url中的动态参数" tabindex="-1">获取URL中的动态参数 <a class="header-anchor" href="#获取url中的动态参数" aria-label="Permalink to &quot;获取URL中的动态参数&quot;">​</a></h4><p>通过<code>req.params</code>对象, 可以访问到URL中的动态参数部分 , 通过<code>:</code>号去匹配参数到 <code>req.params</code>身上</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/user/:id</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,(</span><span style="color:#A6ACCD;font-style:italic;">req</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">///res.params 默认是一个空对象 </span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// 此处的 :id是一个动态参数 , id是参数名</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// :号是动态参数的一个标志 , 这个参数名无所谓</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// 会自动去匹配这个 动态参数 到 res.params身上</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">req</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">params</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">send</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">req</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">params</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><p>此时我们访问<code>http://localhost/user/58</code> , 就会得到数字58</p><h3 id="托管静态资源" tabindex="-1">托管静态资源 <a class="header-anchor" href="#托管静态资源" aria-label="Permalink to &quot;托管静态资源&quot;">​</a></h3><h4 id="express-static" tabindex="-1">express.static() <a class="header-anchor" href="#express-static" aria-label="Permalink to &quot;express.static()&quot;">​</a></h4><p>express提供了一个函数 , 叫做<code>express.static()</code> , 通过他 ,我们可以非常方便地创建一个<strong>静态资源服务器</strong></p><p>我们想去开放某一个目录下的文件, 只需要将这个目录静态托管即可</p><p>如果要访问一些资源,我们只需要在URL跟上资源名, 然后服务器就会去我托管的目录下去寻找并相应给客户端</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#A6ACCD;">(express</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">static</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">目录名</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">))</span><span style="color:#89DDFF;">;</span></span></code></pre></div><p><strong>注意</strong> : <strong>Express在指定的静态目录中去查找文件</strong> , 并对外提供资源的访问路径 , 因此, <strong>存放静态资源的目录名不会出现在URL中</strong></p><p><strong>举个栗子</strong> , 这是我的项目目录结构 , 我要静态托管<code>files</code>文件夹下载的资源</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#A6ACCD;">(express</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">static</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">./</span><span style="color:#A6ACCD;">files))</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//app.use()的用法后面说 , 我也不会(手动狗头)</span></span></code></pre></div><p><img src="https://kkbank.oss-cn-qingdao.aliyuncs.com/note-img/image-20220428214732448.png" alt="image-20220428214732448"></p><p>那么我在请求这个某个资源时 , 就不需要再加上<code>files</code>这个目录名 , 比如说我想要请求<code>flies</code>文件夹下的<code>index.html</code> , 那么我们只需要在URL中这么写<code>http:127.0.0.1/index.html</code>即可, 不需要再加上<code>files</code>目录名</p><h4 id="托管多个静态资源" tabindex="-1">托管多个静态资源 <a class="header-anchor" href="#托管多个静态资源" aria-label="Permalink to &quot;托管多个静态资源&quot;">​</a></h4><p>如果想要托管多个静态资源目录 , 那么我们只需要多次调用<code>express.static()</code>函数即可</p><p><strong>举个栗子</strong> ,我想要托管<code>files</code>和<code>public</code>目录下的静态资源,只需要这么写</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#A6ACCD;">(express</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">static</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./files</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">))</span></span>
<span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#A6ACCD;">(express</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">static</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./public</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">))</span></span></code></pre></div><p><strong>注意</strong> : 我们在访问静态资源时, <code>express.static()</code>就会根据添加目录的顺序去查找所需要的的资源文件</p><p><strong>举个栗子</strong> , 我的<code>flies</code>和<code>public</code>目录下都有一个叫<code>index.html</code>的文件,</p><p>我在这样访问时<code>http://127.0.0.1/index.html</code> , 就会响应给客户端<code>files</code>目录下的<code>index.html</code>文件</p><h4 id="挂载路径前缀" tabindex="-1">挂载路径前缀 <a class="header-anchor" href="#挂载路径前缀" aria-label="Permalink to &quot;挂载路径前缀&quot;">​</a></h4><p>前面说过了,使用<code>express.static()</code>静态托管的目录 ,当我们访问时,不需要在URL中给出目录名</p><p>为了确保URL易理解, 系统易维护,我们可以<strong>自定义一个路径的前缀</strong>,我们在访问里面的资源时,需要在URL中补上这个路径前缀</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">路径前缀</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">express</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">static</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">托管目录</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">))</span></span></code></pre></div><p><strong>举个栗子</strong> , 我托管了<code>files</code>目录下的静态资源, 我还想要别人访问时加上确切的URL路径,这样我在看到这个URL时,就能一眼看出资源的准确位置,我可以这样写</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/files</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">express</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">static</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./files</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">))</span><span style="color:#89DDFF;">;</span></span></code></pre></div><p>访问时<code>http://127.0.0.1/files/index.html</code> 就这样</p><p>看个小的案例 ,同时托管两个目录, 访问<code>files</code>的资源时需要加上<code>files</code>目录名</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">//导入express包</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> express </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">require</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">express</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//新建一个服务器</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> app </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">express</span><span style="color:#A6ACCD;">()</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//静态托管两个目录</span></span>
<span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/files</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">express</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">static</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./files</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">))</span></span>
<span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#A6ACCD;">(express</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">static</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./clock</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">))</span></span>
<span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">listen</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">80</span><span style="color:#89DDFF;">,()</span><span style="color:#C792EA;">=&gt;</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">app is running at http:127.0.0.1</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><h3 id="nodemon" tabindex="-1">nodemon <a class="header-anchor" href="#nodemon" aria-label="Permalink to &quot;nodemon&quot;">​</a></h3><h4 id="介绍" tabindex="-1">介绍 <a class="header-anchor" href="#介绍" aria-label="Permalink to &quot;介绍&quot;">​</a></h4><p>在编写调试Node.js项目时,如果我们经常对项目作出调试 , 我们需要频繁的去关闭服务器,启动服务器 , 非常繁琐</p><p>接下来, 就有了一个好用的小工具 , <code>nodemon</code> , 安装了这个小工具之后,我们每次修改项目代码,他就能够监听到项目文件的变动, 然后自动帮我们重启服务器, 非常NICE!</p><h4 id="安装-1" tabindex="-1">安装 <a class="header-anchor" href="#安装-1" aria-label="Permalink to &quot;安装&quot;">​</a></h4><p>安装还用说嘛? 直接命令行 命令 , 记得一定要全局可用</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">npm i nodemon </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">g</span><span style="color:#89DDFF;">;</span></span></code></pre></div><h4 id="使用" tabindex="-1">使用 <a class="header-anchor" href="#使用" aria-label="Permalink to &quot;使用&quot;">​</a></h4><p>之前我们启动服务, 是用的这个命令<code>node xxx.js</code> , 这样做的坏处上面也说了</p><p>现在我们把<code>node</code>命令替换为<code>nodemon</code>命令 , 使用<code>nodemon xxx.js </code>就可以启动项目 , 并且自动去监听这个文件的代码变动来重启服务</p><p><strong>注意</strong> :是我们<code>ctrl+s</code>保存代码时,会帮我们重启服务</p><h2 id="express路由" tabindex="-1">Express路由 <a class="header-anchor" href="#express路由" aria-label="Permalink to &quot;Express路由&quot;">​</a></h2><h3 id="路由的概念" tabindex="-1">路由的概念 <a class="header-anchor" href="#路由的概念" aria-label="Permalink to &quot;路由的概念&quot;">​</a></h3><h4 id="什么是路由" tabindex="-1">什么是路由 <a class="header-anchor" href="#什么是路由" aria-label="Permalink to &quot;什么是路由&quot;">​</a></h4><p>广义上来讲,路由就是映射关系</p><p><img src="https://kkbank.oss-cn-qingdao.aliyuncs.com/note-img/image-20220429123844599.png" alt="image-20220429123844599"></p><h4 id="express中的路由" tabindex="-1">Express中的路由 <a class="header-anchor" href="#express中的路由" aria-label="Permalink to &quot;Express中的路由&quot;">​</a></h4><p>在Express中,路由指的是<strong>客户端的请求和服务处理函数之间的映射关系</strong></p><p>Express中的路由分3部分组成,分别是<strong>请求的类型 , 请求的URL地址 , 处理函数</strong></p><h4 id="express路由实例" tabindex="-1">Express路由实例 <a class="header-anchor" href="#express路由实例" aria-label="Permalink to &quot;Express路由实例&quot;">​</a></h4><p>这个就是我们前面经常用的例子</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">//匹配GET请求,且请求URL为/</span></span>
<span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#C792EA;">function</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">req</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#89DDFF;">){</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">send</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Hello world</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//匹配POST请求,且请求URL为/</span></span>
<span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">post</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#C792EA;">function</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">req</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#89DDFF;">){</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">send</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">GOT a POST request</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><h4 id="路由的匹配过程" tabindex="-1">路由的匹配过程 <a class="header-anchor" href="#路由的匹配过程" aria-label="Permalink to &quot;路由的匹配过程&quot;">​</a></h4><p>每当一个请求到达服务器之后, 需要先经过路由的匹配 , 只有匹配成功后 , 才会调用对应的处理函数</p><p>在匹配时,<strong>按照路由的顺序进行匹配,如果请求的类型和URL同时匹配,则会执行对应的函数</strong>来处理这次的请求</p><p>就是说,我们可以根据不同的请求类型和不同的URL,定义多个<code>app.get()</code>和<code>app.post()</code> , 当收到一个请求时, 按照刚才定义的顺序去匹配</p><p><img src="https://kkbank.oss-cn-qingdao.aliyuncs.com/note-img/image-20220429124533066.png" alt="image-20220429124533066"></p><p><strong>注意</strong></p><ul><li>按照定义的先后顺序进行匹配</li><li>请求类型和请求URL同时匹配成功,才会调用相应的处理函数</li></ul><h3 id="路由的使用" tabindex="-1">路由的使用 <a class="header-anchor" href="#路由的使用" aria-label="Permalink to &quot;路由的使用&quot;">​</a></h3><h4 id="最简单的用法" tabindex="-1">最简单的用法 <a class="header-anchor" href="#最简单的用法" aria-label="Permalink to &quot;最简单的用法&quot;">​</a></h4><p>也就是我们刚才说的那个示例代码</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> express </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">require</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">express</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//创建web服务器</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> app </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">express</span><span style="color:#A6ACCD;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//挂载路由</span></span>
<span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,(</span><span style="color:#A6ACCD;font-style:italic;">req</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#89DDFF;">)</span><span style="color:#C792EA;">=&gt;</span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">send</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">hello world</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">post</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,(</span><span style="color:#A6ACCD;font-style:italic;">req</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#89DDFF;">)</span><span style="color:#C792EA;">=&gt;</span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">send</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">别发了,我收到了</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//启动web服务器</span></span>
<span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">listen</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">80</span><span style="color:#89DDFF;">,()</span><span style="color:#C792EA;">=&gt;</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">app is running at http://127.0.0.1</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><p>但是这种方法我们一般很少使用, 你想想 , 加入我的项目结构很复杂 , 那岂不是需要些很多的<code>app.get()</code>和<code>app.post()</code> , 整个代码的体量就会很大</p><h4 id="模块化路由" tabindex="-1">模块化路由 <a class="header-anchor" href="#模块化路由" aria-label="Permalink to &quot;模块化路由&quot;">​</a></h4><p>为了方便对路由进行模块化的管理,Express不建议将路由直接挂载到app上 , 而是<strong>推荐将路由抽离为单位的模块</strong> , 简单点说 , 就是我们把挂载路由的部分代码单独放到一个.js文件中</p><ol><li>创建路由模块对应的.js文件</li><li>调用<code>express.Router()</code>函数创建路由对象</li><li>向路由对象上挂载具体的路由</li><li>调用<code>module.exports</code>向外共享这个路由对象</li><li>使用<code>app.use()</code>函数注册路由模块</li></ol><h4 id="创建路由模块" tabindex="-1">创建路由模块 <a class="header-anchor" href="#创建路由模块" aria-label="Permalink to &quot;创建路由模块&quot;">​</a></h4><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">var</span><span style="color:#A6ACCD;"> express </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">require</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">express</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#C792EA;">var</span><span style="color:#A6ACCD;"> router </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> express</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Router</span><span style="color:#A6ACCD;">()</span></span>
<span class="line"><span style="color:#A6ACCD;">router</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/user</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,(</span><span style="color:#A6ACCD;font-style:italic;">req</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">send</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Get User list</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">router</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">post</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/user</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,(</span><span style="color:#A6ACCD;font-style:italic;">req</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">send</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Post a request</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#89DDFF;">module.exports</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> router</span></span></code></pre></div><h4 id="注册路由" tabindex="-1">注册路由 <a class="header-anchor" href="#注册路由" aria-label="Permalink to &quot;注册路由&quot;">​</a></h4><p>在项目文件<code>.js</code> 引入路由模块</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// 导入路由模块</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> userRouter </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">require</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./Router.js</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 使用app.use() 注册路由模块 </span></span>
<span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#A6ACCD;">(userRouter)</span></span></code></pre></div><p>这样访问<code>http://127.0.0.1/user</code></p><h4 id="为路由模块添加前缀" tabindex="-1">为路由模块添加前缀 <a class="header-anchor" href="#为路由模块添加前缀" aria-label="Permalink to &quot;为路由模块添加前缀&quot;">​</a></h4><p>类似于前面所说的静态资源托管 , 路由模块也支持添加前缀的方式</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">//导入路由模块</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> userRouter </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">require</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./Router.js</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//调用app.use()注册路由模块 , 并添加统一的访问前缀 /api</span></span>
<span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/api</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">userRouter)</span></span></code></pre></div><p>这样 , 当我们请求时,需要加上<code>api</code>前缀,<code>http://127.0.0.1/api/user</code></p><h2 id="express中间件" tabindex="-1">Express中间件 <a class="header-anchor" href="#express中间件" aria-label="Permalink to &quot;Express中间件&quot;">​</a></h2><h3 id="中间件的概念" tabindex="-1">中间件的概念 <a class="header-anchor" href="#中间件的概念" aria-label="Permalink to &quot;中间件的概念&quot;">​</a></h3><h4 id="什么是中间件" tabindex="-1">什么是中间件 <a class="header-anchor" href="#什么是中间件" aria-label="Permalink to &quot;什么是中间件&quot;">​</a></h4><p>特指业务流程的中间处理环节</p><p>中间价一般都输输入和输出, <strong>上一级的输出作为下一级的输入</strong></p><p>举个现实生活中的例子</p><p><img src="https://kkbank.oss-cn-qingdao.aliyuncs.com/note-img/image-20220429194046688.png" alt="image-20220429194046688"></p><h4 id="express中间件的调用流程" tabindex="-1">Express中间件的调用流程 <a class="header-anchor" href="#express中间件的调用流程" aria-label="Permalink to &quot;Express中间件的调用流程&quot;">​</a></h4><p>当一个请求达到Express服务器之后, 可以连续调用多个中间件, 从而对这次请求进行预处理</p><p><img src="https://kkbank.oss-cn-qingdao.aliyuncs.com/note-img/image-20220429194223562.png" alt="image-20220429194223562"></p><h4 id="express中间件的格式" tabindex="-1">Express中间件的格式 <a class="header-anchor" href="#express中间件的格式" aria-label="Permalink to &quot;Express中间件的格式&quot;">​</a></h4><p>Express中间件的<strong>本质就是一个function处理函数</strong></p><p><img src="https://kkbank.oss-cn-qingdao.aliyuncs.com/note-img/image-20220429203824176.png" alt="image-20220429203824176"></p><p>前面的路由函数的形参列表只包含<code>req,res</code>两个参数,</p><p>在中间件函数的形参列表中, 必须包含<code>next</code>参数</p><h4 id="next函数的作用" tabindex="-1">next函数的作用 <a class="header-anchor" href="#next函数的作用" aria-label="Permalink to &quot;next函数的作用&quot;">​</a></h4><p><code>next</code>函数是多个中间件连续调用的关键 , 他表示把流转关系转交给下一个中间件或路由</p><p><code>next</code>就好像是C语言中的一个指针 , 他指向下一个中间件或路由</p><p><img src="https://kkbank.oss-cn-qingdao.aliyuncs.com/note-img/image-20220429204051311.png" alt="image-20220429204051311"></p><h3 id="express中间件初体验" tabindex="-1">Express中间件初体验 <a class="header-anchor" href="#express中间件初体验" aria-label="Permalink to &quot;Express中间件初体验&quot;">​</a></h3><h4 id="定义中间件函数" tabindex="-1">定义中间件函数 <a class="header-anchor" href="#定义中间件函数" aria-label="Permalink to &quot;定义中间件函数&quot;">​</a></h4><p>可以通过如下的方式, 定义一个最简单的中间件函数</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">//常量mw 所指向的,就是一个中间件函数</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> mw </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">req</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">next</span><span style="color:#89DDFF;">){</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">这是一个最简单的中间件函数</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//注意, 在当前中间件的业务处理完毕后, 必须调用next()方法</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//表示把流转关系转交给下一个中间件或路由</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">next</span><span style="color:#F07178;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><h4 id="全局生效的中间件" tabindex="-1">全局生效的中间件 <a class="header-anchor" href="#全局生效的中间件" aria-label="Permalink to &quot;全局生效的中间件&quot;">​</a></h4><p><strong>客户端发起的任何请求, 到达服务器之后 , 就会触发的中间件 ,叫做全局生效的中间件</strong></p><p>通过调用<code>app.use(中间件函数)</code> , 即可定义一个全局生效的中间件函数</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">//常量mw 所指向的,就是一个中间件函数</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> mw </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">req</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">next</span><span style="color:#89DDFF;">){</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">这是一个最简单的中间件函数</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//注意, 在当前中间件的业务处理完毕后, 必须调用next()方法</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//表示把流转关系转交给下一个中间件或路由</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">next</span><span style="color:#F07178;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#A6ACCD;">(mw)</span></span></code></pre></div><h4 id="定义全局中间件的简化形式" tabindex="-1">定义全局中间件的简化形式 <a class="header-anchor" href="#定义全局中间件的简化形式" aria-label="Permalink to &quot;定义全局中间件的简化形式&quot;">​</a></h4><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">//全局生效的中间件的简化形式</span></span>
<span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#A6ACCD;">(</span><span style="color:#C792EA;">function</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">req</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">next</span><span style="color:#89DDFF;">){</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">这是一个中间件函数</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">next</span><span style="color:#F07178;">()</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><h4 id="中间件的作用" tabindex="-1">中间件的作用 <a class="header-anchor" href="#中间件的作用" aria-label="Permalink to &quot;中间件的作用&quot;">​</a></h4><p>多个中间件之间 , **共享同一份req和res ** , 基于这样的特性 , 我们可以在上游的中间件中,统一为req或res对象添加自定义的属性或方法 , 供下游的中间件或路由进行使用</p><p><img src="https://kkbank.oss-cn-qingdao.aliyuncs.com/note-img/image-20220429210318783.png" alt="image-20220429210318783"></p><h4 id="定义多个全局中间件" tabindex="-1">定义多个全局中间件 <a class="header-anchor" href="#定义多个全局中间件" aria-label="Permalink to &quot;定义多个全局中间件&quot;">​</a></h4><p>当我们定义了多个全局中间件时 , 程序会按照全局中间件的顺序来依次处理</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> express </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">require</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">express</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> app </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">express</span><span style="color:#A6ACCD;">()</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//这是第一个全局中间件</span></span>
<span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">req</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">next</span><span style="color:#89DDFF;">)</span><span style="color:#C792EA;">=&gt;</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">经过第一次处理</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">next</span><span style="color:#F07178;">()</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//这是第二个全局中间件</span></span>
<span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">req</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">next</span><span style="color:#89DDFF;">)</span><span style="color:#C792EA;">=&gt;</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">经过第二次处理</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">next</span><span style="color:#F07178;">()</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/user</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,(</span><span style="color:#A6ACCD;font-style:italic;">req</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#89DDFF;">)</span><span style="color:#C792EA;">=&gt;</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">send</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">User page</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">listen</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">80</span><span style="color:#89DDFF;">,()</span><span style="color:#C792EA;">=&gt;</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">app is running</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><h4 id="局部生效的中间件" tabindex="-1">局部生效的中间件 <a class="header-anchor" href="#局部生效的中间件" aria-label="Permalink to &quot;局部生效的中间件&quot;">​</a></h4><p>不使用<code>app.use()</code>定义的中间件 , 叫做局部生效的中间件</p><p>想要在哪个地方使用中间件函数, 直接在哪个地方调用即可</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> express </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">require</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">express</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> app </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">express</span><span style="color:#A6ACCD;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//定义一个中间件函数</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> m1 </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">req</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">next</span><span style="color:#89DDFF;">)</span><span style="color:#C792EA;">=&gt;</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">我是一个局部生效的中间件</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">next</span><span style="color:#F07178;">()</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//我们想要这个中间件函数只在第一个路由中生效</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//只需要将这个中间件函数放在路由处理函数前面的参数位置即可</span></span>
<span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">m1</span><span style="color:#89DDFF;">,(</span><span style="color:#A6ACCD;font-style:italic;">req</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#89DDFF;">)</span><span style="color:#C792EA;">=&gt;</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">send</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Home page</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/user</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,(</span><span style="color:#A6ACCD;font-style:italic;">req</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#89DDFF;">)</span><span style="color:#C792EA;">=&gt;</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">send</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">user page</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">listen</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">80</span><span style="color:#89DDFF;">,()</span><span style="color:#C792EA;">=&gt;</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">app is running</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><h4 id="定义多个局部中间件" tabindex="-1">定义多个局部中间件 <a class="header-anchor" href="#定义多个局部中间件" aria-label="Permalink to &quot;定义多个局部中间件&quot;">​</a></h4><p>可以在路由中, 通过如下两种等价的方式 , 使用多个局部中间件</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">//以下两种写法是完全等价的</span></span>
<span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">m1</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">m2</span><span style="color:#89DDFF;">,(</span><span style="color:#A6ACCD;font-style:italic;">req</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#89DDFF;">)</span><span style="color:#C792EA;">=&gt;</span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">send</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">HOme page</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">[m1</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">m2]</span><span style="color:#89DDFF;">,(</span><span style="color:#A6ACCD;font-style:italic;">req</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#89DDFF;">)</span><span style="color:#C792EA;">=&gt;</span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">send</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">HOMe Page</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><p>也是按照局部中间件的顺序去调用的</p><h4 id="了解中间件的5个使用注意事项" tabindex="-1">了解中间件的5个使用注意事项 <a class="header-anchor" href="#了解中间件的5个使用注意事项" aria-label="Permalink to &quot;了解中间件的5个使用注意事项&quot;">​</a></h4><ul><li><strong>一定要在路由之前注册中间件</strong> , 因为整个程序是从前到后执行的 , 如果中间价在路由之后, 那么久直接响应给客户端了 , 中间件就没有用了</li><li>执行完中间件的处理后, <strong>千万别忘记调用<code>next()</code>函数</strong></li><li><strong>调用完<code>next()</code>之后, 就不要再写多余的代码了</strong> , 因为执行到<code>next()</code>的时候,就已经转入下一个中间件或者路由了, <code>next()</code>后面的代码就屁用没有了</li></ul><h3 id="中间件的分类" tabindex="-1">中间件的分类 <a class="header-anchor" href="#中间件的分类" aria-label="Permalink to &quot;中间件的分类&quot;">​</a></h3><p>为了方便使用 , Express官方把常见的中间件用法 , 分成了5大类 , 分别是</p><ul><li><strong>应用级别</strong>的中间件</li><li><strong>路由级别</strong>的中间件</li><li><strong>错误级别</strong>的中间件</li><li>Express <strong>内置的中间件</strong></li><li>第三方的中间件</li></ul><h4 id="应用级别的中间件" tabindex="-1">应用级别的中间件 <a class="header-anchor" href="#应用级别的中间件" aria-label="Permalink to &quot;应用级别的中间件&quot;">​</a></h4><p>通过<code>app.use()</code>或<code>app.get()</code>或<code>app.post()</code> , 绑定到app实例上的中间件 , 叫做应用级别的中间件</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">req</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">next</span><span style="color:#89DDFF;">)</span><span style="color:#C792EA;">=&gt;</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">经过第一次处理</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">next</span><span style="color:#F07178;">()</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">[m1</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">m2]</span><span style="color:#89DDFF;">,(</span><span style="color:#A6ACCD;font-style:italic;">req</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#89DDFF;">)</span><span style="color:#C792EA;">=&gt;</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">send</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Home page</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><h4 id="路由级别的中间件" tabindex="-1">路由级别的中间件 <a class="header-anchor" href="#路由级别的中间件" aria-label="Permalink to &quot;路由级别的中间件&quot;">​</a></h4><p>绑定到<code>express.Router()</code>实例上的中间件 , 叫做路由级别的中间件 , 他的用法和应用级别中间件相同.</p><p>只不过,应用级别的中间件是绑定到app实例上的 , 路由级别的中间件是绑定到<code>router</code>实例上,</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> router </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> express</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Router</span><span style="color:#A6ACCD;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//路由级别的中间件</span></span>
<span class="line"><span style="color:#A6ACCD;">router</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#A6ACCD;">(</span><span style="color:#C792EA;">function</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">req</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">next</span><span style="color:#89DDFF;">){</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">到达路由级别中间件</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">next</span><span style="color:#F07178;">()</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#A6ACCD;">(router)</span></span></code></pre></div><h4 id="错误级别的中间件" tabindex="-1">错误级别的中间件 <a class="header-anchor" href="#错误级别的中间件" aria-label="Permalink to &quot;错误级别的中间件&quot;">​</a></h4><p><strong>作用: 专门用来捕获项目中发生的异常 , 从而防止项目异常崩溃</strong></p><p><strong>当项目中发生错误时 , 就会直接进入到错误级别的中间件 进行处理</strong></p><p><strong>格式</strong> : 错误级别的中间件处理函数 , 必须有4个形参 , 且这四个形参的顺序不能乱,分别是<code>(err,req,res,next)</code></p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,(</span><span style="color:#A6ACCD;font-style:italic;">req</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#89DDFF;">)</span><span style="color:#C792EA;">=&gt;</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">throw</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">new</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">Error</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">服务器内部发生错误</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">send</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Home page</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">err</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">req</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">next</span><span style="color:#89DDFF;">)</span><span style="color:#C792EA;">=&gt;</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">发生了错误:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;">err</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">message</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">send</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Error:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;">err</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">message</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><p>项目发生错误后, 直接进入错误级别中间件</p><p><strong>注意</strong> : 错误级别中中间件 , <strong>必须注册在所有路由之后</strong> , 否则无效</p><h4 id="express内置的中间件" tabindex="-1">Express内置的中间件 <a class="header-anchor" href="#express内置的中间件" aria-label="Permalink to &quot;Express内置的中间件&quot;">​</a></h4><p>自express4.16.0版本之后 , Express内置了3个常用的中间件 , 极大地提高了Express项目的开发效率和体验</p><ul><li><code>express.static</code> 快速静态托管静态资源的内置中间件 , 例如 , HTML 文件 , 图片 ,css样式</li><li><code>express.json</code> 解析JSON格式的请求体数据</li><li><code>express.urlencoded</code> 解析URL-encoded格式的请求体数据</li></ul><p>使用时只需要配置一下中间件即可</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">//配置全局中间件</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//配置解析application/json格式数据的内置中间件</span></span>
<span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#A6ACCD;">(express</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">json</span><span style="color:#A6ACCD;">())</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//配置解析application/x-www-form-urlencoded格式数据的内置中间件</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//x-www-form-urlencode格式的数据就是表单数据</span></span>
<span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#A6ACCD;">(express</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">urlencoded</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span><span style="color:#F07178;">extended</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">false</span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">))</span></span></code></pre></div><p>看一个实例 , <code>express.json</code>的使用 , 向服务器发送一个json格式的数据</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> express </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">require</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">express</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> app </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">express</span><span style="color:#A6ACCD;">()</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//配置全局中间件</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 配置解析application/json格式数据的内置中间件</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//通过这个中间件, 就会将解析出来的数据挂载到req.body身上</span></span>
<span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#A6ACCD;">(express</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">json</span><span style="color:#A6ACCD;">())</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">post</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/user</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">req</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//在服务器 , 可以使用req.body这个属性 </span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//来接收客户端发送过来的请求体数据</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//默认情况下 , 如不配置解析表单数据的中间件 , </span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//则req.body默认等于undefined</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">req</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">body</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">send</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">ok</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">listen</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">80</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">app is running</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><p><code>express.urlencoded</code>的使用, 向服务器发送一个<code>x-www-form-urlencoded</code>格式的数据</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> express </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">require</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">express</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> app </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">express</span><span style="color:#A6ACCD;">()</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//配置全局中间件</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//配置解析application/x-www-form-urlencoded格式数据的内置中间件</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//需要传一个配置对象 </span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//将解析出来的数据挂载到req.body身上</span></span>
<span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#A6ACCD;">(express</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">urlencoded</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span><span style="color:#F07178;">extended</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">false</span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">post</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/book</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,(</span><span style="color:#A6ACCD;font-style:italic;">req</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//在服务器端 , 可以通过req.body来获取json格式的表单数据和url-encoded格式的数据</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//url-encoded是一种键值对形式的数据</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">req</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">body</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">send</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">OK</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">listen</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">80</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">app is running</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><h4 id="第三方的中间件" tabindex="-1">第三方的中间件 <a class="header-anchor" href="#第三方的中间件" aria-label="Permalink to &quot;第三方的中间件&quot;">​</a></h4><p>非 Express 官方内置的，而是由第三方开发出来的中间件，叫做第三方中间件。在项目中，大家可以按需下载并配置第三方中间件，从而提高项目的开发效率。</p><p><img src="https://kkbank.oss-cn-qingdao.aliyuncs.com/note-img/image-20220430123214310.png" alt="image-20220430123214310"></p><p><strong>注意</strong>: express内置的<code>express.urlencoded</code>中间件就是基于body-parser这个第三方中间件进一步封装出来的 , 4.16之后的版本就不需要安装上面提到的那个插件了</p><h3 id="自定义中间件" tabindex="-1">自定义中间件 <a class="header-anchor" href="#自定义中间件" aria-label="Permalink to &quot;自定义中间件&quot;">​</a></h3><h4 id="需求描述与实现步骤" tabindex="-1">需求描述与实现步骤 <a class="header-anchor" href="#需求描述与实现步骤" aria-label="Permalink to &quot;需求描述与实现步骤&quot;">​</a></h4><p>自己手动模拟一个类似于<code>express.urlencoded</code>这样的中间件 , 来解析POST提交到服务器的表单数据</p><p>实现步骤</p><ol><li>定义中间件</li><li>监听 req 的 data 事件</li><li>监听 req 的 end 事件</li><li>使用 querystring 模块解析请求体数据</li><li>将解析出来的数据对象挂载为 req.body</li><li>将自定义中间件封装为模块</li></ol><h4 id="定义中间件" tabindex="-1">定义中间件 <a class="header-anchor" href="#定义中间件" aria-label="Permalink to &quot;定义中间件&quot;">​</a></h4><p>使用<code>app.use()</code>来配置全局中间件</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#A6ACCD;">((req</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">next)</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">	</span><span style="color:#676E95;font-style:italic;">//.....        </span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><h4 id="监听req的data事件" tabindex="-1">监听req的data事件 <a class="header-anchor" href="#监听req的data事件" aria-label="Permalink to &quot;监听req的data事件&quot;">​</a></h4><p>在中间件中国 , 需要监听req对象的data事件, 来获取客户端发送到服务器的数据</p><p>如果数据量比较大 , <strong>无法一次性发送完毕 , 则客户端会把数据切割后</strong> , 分批发送到服务器</p><p>所以data事件可能会触发多次 , 每一次触发data事件 , <strong>获取到数据只是完整数据的一部分,</strong> 需要手动对接收到的数据进行拼接</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">//待拼接的字符串</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> str </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">    req</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">on</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">data</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,(</span><span style="color:#A6ACCD;font-style:italic;">chunk</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">str</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">+=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">chunk</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><h4 id="监听req的end事件" tabindex="-1">监听req的end事件 <a class="header-anchor" href="#监听req的end事件" aria-label="Permalink to &quot;监听req的end事件&quot;">​</a></h4><p>当请求体数据<strong>接收完毕</strong>之后, 会自动触发req的end 事件</p><p>因此我们可以在req的end事件中 , <strong>拿到并处理完整的请求体数据</strong></p><h4 id="使用querystring模块解析请求体数据" tabindex="-1">使用querystring模块解析请求体数据 <a class="header-anchor" href="#使用querystring模块解析请求体数据" aria-label="Permalink to &quot;使用querystring模块解析请求体数据&quot;">​</a></h4><p>Node.js内置了一个<code>querystring</code>模块 , 专门用来处理查询字符串, 通过这个模块提供的<code>parse()</code>函数 , 可以轻松把<strong>查询字符串, 解析成对象的格式</strong></p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">req</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">on</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">end</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,()</span><span style="color:#C792EA;">=&gt;</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">//在str中存放的是完整的数</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">// console.log(str)</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">//把字符串解析为对象格式</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">body</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">qs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">parse</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">str</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">body</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><p>整体代码</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> express </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">require</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">express</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> res </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">require</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">express/lib/response</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> qs </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">require</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">querystring</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> app </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">express</span><span style="color:#A6ACCD;">()</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//这是解析表单数据的中间件</span></span>
<span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">req</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">next</span><span style="color:#89DDFF;">)</span><span style="color:#C792EA;">=&gt;</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//定义中间件的逻辑处理</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//待拼接的字符串</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">str</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;&#39;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">req</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">on</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">data</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,(</span><span style="color:#A6ACCD;font-style:italic;">chunk</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">str</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">+=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">chunk</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">req</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">on</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">end</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,()</span><span style="color:#C792EA;">=&gt;</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">//在str中存放的是完整的数</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">// console.log(str)</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">//把字符串解析为对象格式</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">body</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">qs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">parse</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">str</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">body</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">req</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">body</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">body</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#82AAFF;">next</span><span style="color:#F07178;">()</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">post</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/user</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,(</span><span style="color:#A6ACCD;font-style:italic;">req</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#89DDFF;">)</span><span style="color:#C792EA;">=&gt;</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">send</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">req</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">body</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">listen</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">80</span><span style="color:#89DDFF;">,()</span><span style="color:#C792EA;">=&gt;</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">app is running</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><h4 id="将解析出来的数据对象挂载为req-body" tabindex="-1">将解析出来的数据对象挂载为req.body <a class="header-anchor" href="#将解析出来的数据对象挂载为req-body" aria-label="Permalink to &quot;将解析出来的数据对象挂载为req.body&quot;">​</a></h4><p>因为整个过程中, 中间件和路由共享同一份<code>req</code>和<code>res</code> , 所以可以在上游中间件中挂载自定义属性</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">red</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">body </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> body</span></span></code></pre></div><h4 id="将自定义中间件封装为模块" tabindex="-1">将自定义中间件封装为模块 <a class="header-anchor" href="#将自定义中间件封装为模块" aria-label="Permalink to &quot;将自定义中间件封装为模块&quot;">​</a></h4><p>为了优化代码结构, 我们把自定义的中间件函数 , 封装为独立的模块, 向外共享这个函数</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> qs </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">require</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">querystring</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//定义一个中间件函数</span></span>
<span class="line"><span style="color:#82AAFF;">my_urlencoded</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">req</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">next</span><span style="color:#89DDFF;">)</span><span style="color:#C792EA;">=&gt;</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//定义中间件的逻辑处理</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//待拼接的字符串</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">str</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;&#39;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">req</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">on</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">data</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,(</span><span style="color:#A6ACCD;font-style:italic;">chunk</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">str</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">+=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">chunk</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">req</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">on</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">end</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,()</span><span style="color:#C792EA;">=&gt;</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">//在str中存放的是完整的数</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">// console.log(str)</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">//把字符串解析为对象格式</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">body</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">qs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">parse</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">str</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">body</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">req</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">body</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">body</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#82AAFF;">next</span><span style="color:#F07178;">()</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">module.exports</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    my_urlencoded</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><h2 id="使用express写接口" tabindex="-1">使用Express写接口 <a class="header-anchor" href="#使用express写接口" aria-label="Permalink to &quot;使用Express写接口&quot;">​</a></h2><p>到此为止, Express的基本使用已经了解的差不多了</p><p>汇总一下整个Express的基本使用</p><h3 id="创建基本的服务器" tabindex="-1">创建基本的服务器 <a class="header-anchor" href="#创建基本的服务器" aria-label="Permalink to &quot;创建基本的服务器&quot;">​</a></h3><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> express </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">require</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">express</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//创建一个服务器实例</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> app </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">express</span><span style="color:#A6ACCD;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//导入路由模块</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//启动服务</span></span>
<span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">listen</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">80</span><span style="color:#89DDFF;">,()</span><span style="color:#C792EA;">=&gt;</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">server is running </span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><h3 id="创建api路由模块" tabindex="-1">创建API路由模块 <a class="header-anchor" href="#创建api路由模块" aria-label="Permalink to &quot;创建API路由模块&quot;">​</a></h3><p>将服务器的路由封装为一个独立的模块</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> express </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">require</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">express</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//创建实例路由</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> apiRouter </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> express</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Router</span><span style="color:#A6ACCD;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//.....</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//向外共享这个路由</span></span>
<span class="line"><span style="color:#89DDFF;">module.exports</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    apiRouter</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><h3 id="编写get接口" tabindex="-1">编写GET接口 <a class="header-anchor" href="#编写get接口" aria-label="Permalink to &quot;编写GET接口&quot;">​</a></h3><p>在路由模块中编写GET接口</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">apiRouter</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/get</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,(</span><span style="color:#A6ACCD;font-style:italic;">req</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//通过req.query获取用户端通过查询字符串,发送到服务器的数据</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">query</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">req</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">query</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//调用res.send()方法 , 向客户端响应处理的结果</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">send</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        status</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">        msg</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Get请求成功</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">        data</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">query</span><span style="color:#F07178;"> </span><span style="color:#676E95;font-style:italic;">//原封不动的返回</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><h3 id="编写post接口" tabindex="-1">编写POST接口 <a class="header-anchor" href="#编写post接口" aria-label="Permalink to &quot;编写POST接口&quot;">​</a></h3><p>在路由模块中编写POST 接口</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">//想要获得请求体的数据,必须要配置中间件</span></span>
<span class="line"><span style="color:#A6ACCD;">apiRouter</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">post</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/post</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,(</span><span style="color:#A6ACCD;font-style:italic;">req</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#89DDFF;">)</span><span style="color:#C792EA;">=&gt;</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//通过req.body获得请求体</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">body</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">req</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">body</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">send</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        status</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">        msg</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Post请求成功</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">        data</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">body</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><h3 id="cors跨域资源共享" tabindex="-1">CORS跨域资源共享 <a class="header-anchor" href="#cors跨域资源共享" aria-label="Permalink to &quot;CORS跨域资源共享&quot;">​</a></h3><h4 id="接口的跨域问题" tabindex="-1">接口的跨域问题 <a class="header-anchor" href="#接口的跨域问题" aria-label="Permalink to &quot;接口的跨域问题&quot;">​</a></h4><p>刚才编写的GET和POST接口, 存在一个很严重的问题,, 不支持<strong>跨域请求</strong></p><p>当我们在使用浏览器打开一个HTML文件时 , 在页面中点击按钮来发起请求 , 就会报错.</p><p>因为, 我们打开HTML文件是按照<code>file</code>协议 , 而请求服务器接口却使用的是<code>http</code>协议 , 协议不统一,所以会产生跨域问题</p><p>只要是协议,域名或端口号上的不同 , 就会产生跨域问题</p><p>解决接口跨域问题的方案主要有两种</p><ul><li>CORS (主流的解决方案 , 推荐使用)</li><li>JSONP (有缺陷的解决方案 , <strong>只支持GET请求)</strong></li></ul><h4 id="使用cors解决跨域问题" tabindex="-1">使用cors解决跨域问题 <a class="header-anchor" href="#使用cors解决跨域问题" aria-label="Permalink to &quot;使用cors解决跨域问题&quot;">​</a></h4><p>CORS是Express的一个第三方中间件 , 通过安装和配置CORS中间件 , 可以很方便地解决跨域问题</p><p>还是基本的老套路</p><ol><li>安装cors , <code>npm i cors</code></li><li>导入cors , <code>const cors = require(&#39;cors&#39;)</code></li><li>在路由之前配置cors , 调用<code>app.use(cors)</code>配置中间件</li></ol><h4 id="什么是cors" tabindex="-1">什么是CORS <a class="header-anchor" href="#什么是cors" aria-label="Permalink to &quot;什么是CORS&quot;">​</a></h4><p>CORS(Cross-Orign Resource Sharing ,跨域资源共享)由一系列<strong>HTTP响应头</strong>组成 , 这些<strong>HTTP响应头决定浏览器是否阻止前端JS代码跨域获取资源</strong></p><p>浏览器的<strong>同源安全策略</strong>默认会阻止网页跨域资源获取 , 但如果接口服务器配置了<strong>CORS相关的HTTP响应头</strong> , 就可以<strong>解决浏览器端的跨域访问限制</strong></p><p><img src="https://kkbank.oss-cn-qingdao.aliyuncs.com/note-img/image-20220502175528741.png" alt="image-20220502175528741"></p><h4 id="cors的注意事项" tabindex="-1">CORS的注意事项 <a class="header-anchor" href="#cors的注意事项" aria-label="Permalink to &quot;CORS的注意事项&quot;">​</a></h4><ul><li>CORS 主要在服务器端进行配置。客户端浏览器<strong>无须做任何额外的配置</strong>，即可请求开启了 CORS 的接口。</li><li>CORS 在浏览器中有兼容性。只有支持 XMLHttpRequest Level2 的浏览器，才能正常访问开启了 CORS 的服务端接口（例如：IE10+、Chrome4+、FireFox3.5+）</li></ul><h4 id="cors响应头部" tabindex="-1">CORS响应头部 <a class="header-anchor" href="#cors响应头部" aria-label="Permalink to &quot;CORS响应头部&quot;">​</a></h4><ol><li>-Access-Control-Allow-Origin</li></ol><p>响应头部中可以携带一个<code>Access-Control-Allow-Orign</code>字段</p><p>语法:</p><div class="language-c"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">Access</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">Control</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">Allow</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">Orign: </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">origin</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span></span></code></pre></div><p><code>&lt;origin&gt;</code> : 参数指定了允许访问该资源的外域URL</p><p><strong>举个栗子</strong> : 下面的字段值 只允许来自<code>http:itkkk.blog.csdn.net</code>的请求</p><div class="language-c"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">res.</span><span style="color:#82AAFF;">setHeader</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Access-Control-Allow-Orign</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">http://itkkk.blog.csdn.net</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span></code></pre></div><p><code>通配符*</code>表示允许来自任何域的请求</p><div class="language-c"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">res.</span><span style="color:#82AAFF;">setHeader</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Access-Control-Allow-Origin</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">*</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span></code></pre></div><ol start="2"><li>-Access-Control-Allow-Headers</li></ol><p>默认情况下 , CORS<strong>仅</strong>支持客户端向服务器发送如下的9个请求头</p><p>Accept、Accept-Language、Content-Language、DPR、Downlink、Save-Data、Viewport-Width、Width 、Content-Type （值仅限于 text/plain、multipart/form-data、application/x-www-form-urlencoded 三者之一）</p><p>如果客户端向服务器<strong>发送了额外的请求头信息，则需要在服务器端，通过 Access-Control-Allow-Headers 对额外的请求头进行声明，否则这次请求会失败！</strong></p><p><strong>举个栗子</strong></p><div class="language-c"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">//允许客户端向服务器发送Content-Type请求头和X-Custom-Header请求头</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//注意 : 多个请求头之间使用英文逗号进行分隔</span></span>
<span class="line"><span style="color:#A6ACCD;">res.</span><span style="color:#82AAFF;">setHeader</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Access-Control-Allow-Headers</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Content-Type,X-Custom-Header</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span></code></pre></div><ol start="3"><li>-Access-Control-Allow-Methods</li></ol><p>默认情况下 , Cors仅支持客户端发起GET , POST ,HEAD 请求</p><p>如果客户端希望通过<code>PUT,DELETE</code>等方式请求服务器的资源 , 则需要在服务器端,通过<code>Access-Control-Allow-Methods</code>来<strong>指明实际请求所允许使用的HTTP方法</strong></p><p><strong>举个栗子</strong></p><div class="language-c"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">//只允许POST , GET , DELETE , HEAD请求方法 </span></span>
<span class="line"><span style="color:#A6ACCD;">res.</span><span style="color:#82AAFF;">setHeader</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Access-Control-Allow-Methods</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">POST,GET,DELETE,HEAD</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//允许所有的HTTP请求方法    </span></span>
<span class="line"><span style="color:#A6ACCD;">res.</span><span style="color:#82AAFF;">setHeader</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Access-Control-Allow-Methods</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">*</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">)</span></span></code></pre></div><h4 id="cors请求的分类" tabindex="-1">CORS请求的分类 <a class="header-anchor" href="#cors请求的分类" aria-label="Permalink to &quot;CORS请求的分类&quot;">​</a></h4><p>客户端在请求CORS接口时 , 根据请求方式和请求头的不同 , 可以将CORS的请求分为两大类, 分别是</p><ol><li>简单请求</li><li>预检请求</li></ol><h4 id="简单请求" tabindex="-1">简单请求 <a class="header-anchor" href="#简单请求" aria-label="Permalink to &quot;简单请求&quot;">​</a></h4><p>同时满足以下两大条件的请求 , 就属于简单请求</p><ol><li><strong>请求方式</strong> : GET , POST ,HEAD三者之一</li><li><strong>HTTP头部信息</strong> 不超过以下几种字段: <strong>无自定义头部字段</strong>, Accept、Accept-Language、Content-Language、DPR、Downlink、Save-Data、Viewport-Width、Width 、Content-Type （值仅限于 text/plain、multipart/form-data、application/x-www-form-urlencoded 三者之一）</li></ol><h4 id="预检请求" tabindex="-1">预检请求 <a class="header-anchor" href="#预检请求" aria-label="Permalink to &quot;预检请求&quot;">​</a></h4><p>只要符合任何一个条件的请求 , 都需要进行预检请求</p><ol><li>请求方式为<strong>GET, POST ,HEAD之外的请求Method类型</strong></li><li>请求头中包含自定义头部字段</li><li>向服务器发送了<strong>application格式的数据</strong></li></ol><p>在浏览器与服务器正式通信之前 , 浏览器会发送OPTION请求进行预检 ,以获知服务器是否允许该实际请求 , 所以这一次的OPTION请求称为&quot;预检请求&quot; ,, <strong>服务器成功响应预检请求后 , 才会发送真正的请求 , 并且携带真实数据</strong></p><h4 id="简单请求和预检请求的区别" tabindex="-1">简单请求和预检请求的区别 <a class="header-anchor" href="#简单请求和预检请求的区别" aria-label="Permalink to &quot;简单请求和预检请求的区别&quot;">​</a></h4><p>**简单请求的特点: ** 客户端与服务器之间只会发生一次请求</p><p><strong>预检请求的特点</strong>: 客户端与服务器之间会发生两次请求 , <strong>OPTIION预检请求成功之后 , 才会发起真正的请求</strong></p><h3 id="jsonp接口" tabindex="-1">JSONP接口 <a class="header-anchor" href="#jsonp接口" aria-label="Permalink to &quot;JSONP接口&quot;">​</a></h3><h4 id="什么是jsonp" tabindex="-1">什么是JSONP <a class="header-anchor" href="#什么是jsonp" aria-label="Permalink to &quot;什么是JSONP&quot;">​</a></h4><p>概念**: 浏览器通过<code>&lt;script&gt;</code>标签的<code>src</code>属性 , 请求服务器上的数据 , 同时服务器返回一个函数的调用 . 这种请求数据的方式叫做JSONP**</p><p><strong>通俗点说,就是浏览器通过<code>&lt;script&gt;</code>标签向服务器发送一个函数的名字, 希望服务器返回这个函数的调用 , 在调用期间将数据传进来处理即可</strong></p><p><strong>特点</strong></p><ol><li>JSONP不属于真正的AJAX请求 , 因为他没有使用<code>XMLHttpRequest</code>这个对象</li><li>JSONP仅支持GET请求 , 不支持POST , PUT , HEAD等请求</li></ol><h4 id="创建jsonp接口的注意事项" tabindex="-1">创建JSONP接口的注意事项 <a class="header-anchor" href="#创建jsonp接口的注意事项" aria-label="Permalink to &quot;创建JSONP接口的注意事项&quot;">​</a></h4><p><strong>如果项目中已经配置了CORS跨域资源共享 , 为了防止冲突 , 必须在配置CORS中间件之前声明JSONP的接口 . 否则 JSONP接口会被处理成开启了CORS的接口</strong></p><div class="language-c"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">//优先创建 JSONP 接口[这个窗口不会被处理成CORS 接口]</span></span>
<span class="line"><span style="color:#A6ACCD;">app.</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/api/jsonp</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,(</span><span style="color:#A6ACCD;">req</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=&gt;{})</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//再配置CORS中间件 [后续的所有接口,都会被处理成CORS接口]    </span></span>
<span class="line"><span style="color:#A6ACCD;">app.</span><span style="color:#82AAFF;">use</span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">cors</span><span style="color:#89DDFF;">())</span><span style="color:#A6ACCD;">    </span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//这是一个开启了CORS 的接口</span></span>
<span class="line"><span style="color:#A6ACCD;">app.</span><span style="color:#82AAFF;">get</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/api/get</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,(</span><span style="color:#A6ACCD;">req</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">)=&gt;{})</span></span></code></pre></div><h4 id="实现jsonp接口的步骤" tabindex="-1">实现JSONP接口的步骤 <a class="header-anchor" href="#实现jsonp接口的步骤" aria-label="Permalink to &quot;实现JSONP接口的步骤&quot;">​</a></h4><ol><li><strong>获取客户端发送过来的回调函数的名字</strong></li><li>得到要通过 JSONP 形式发送给客户端的数据</li><li>根据前两步得到的数据，拼接出一个函数调用的字符串</li><li>把上一步拼接得到的字符串，响应给客户端的 <code>&lt;script&gt; </code>标签进行解析执行</li></ol><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// 必须在配置 cors 中间件之前，配置 JSONP 的接口</span></span>
<span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/api/jsonp</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">req</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// TODO: 定义 JSONP 接口具体的实现过程</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// 1. 得到函数的名称</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">funcName</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">req</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">query</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">callback</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// 2. 定义要发送到客户端的数据对象</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">data</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> name</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">zs</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> age</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">22</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// 3. 拼接出一个函数的调用 , 这里面是函数的调用</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">scriptStr</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">`${</span><span style="color:#A6ACCD;">funcName</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;">(</span><span style="color:#89DDFF;">${</span><span style="color:#A6ACCD;">JSON</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">stringify</span><span style="color:#A6ACCD;">(data)</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;">)</span><span style="color:#89DDFF;">`</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// 4. 把拼接的字符串，响应给客户端</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">send</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">scriptStr</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><h4 id="在网页中使用jquery发起jsonp请求" tabindex="-1">在网页中使用jQuery发起JSONP请求 <a class="header-anchor" href="#在网页中使用jquery发起jsonp请求" aria-label="Permalink to &quot;在网页中使用jQuery发起JSONP请求&quot;">​</a></h4><p>前面讲了JSONP的基本使用 , 现在一个小实例 , 通过jquery发起JSONP请求</p><p>调用<code>$.ajax()</code>函数 , 提供JSONP的配置选项 , 从而发起JSONP请求</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// 4. 为 JSONP 按钮绑定点击事件处理函数</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#82AAFF;">$</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">#btnJSONP</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">on</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">click</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#A6ACCD;">$</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">ajax</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">            type</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">GET</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">            url</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">http://127.0.0.1/api/jsonp</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">            dataType</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">jsonp</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#82AAFF;">success</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">function</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">              </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">res</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#F07178;">          </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><h1 id="web开发模式" tabindex="-1">Web开发模式 <a class="header-anchor" href="#web开发模式" aria-label="Permalink to &quot;Web开发模式&quot;">​</a></h1><p>目前主流的Web开发模式有两种 , 分别是</p><ol><li>基于<strong>服务端渲染</strong> 的传统Web开发模式</li><li>基于<strong>前后端分离</strong> 的新型Web开发模式</li></ol><h2 id="服务端渲染" tabindex="-1">服务端渲染 <a class="header-anchor" href="#服务端渲染" aria-label="Permalink to &quot;服务端渲染&quot;">​</a></h2><p>服务端渲染的概念</p><p><strong>服务器发送给客户端的HTML页面 , 是在服务器通过内容拼接, 动态生成的</strong> , 因此客户端不需要使用<strong>ajax</strong>这样的额外技术来请求页面数据</p><h3 id="服务端渲染的优缺点" tabindex="-1">服务端渲染的优缺点 <a class="header-anchor" href="#服务端渲染的优缺点" aria-label="Permalink to &quot;服务端渲染的优缺点&quot;">​</a></h3><h4 id="优点" tabindex="-1">优点 <a class="header-anchor" href="#优点" aria-label="Permalink to &quot;优点&quot;">​</a></h4><ol><li><strong>前端耗时少</strong> , 服务器负责动态生成HTML内容 , 浏览器只是直接渲染页面即可,尤其是移动端,更省电</li><li><strong>有利于SEO</strong> , 因为服务器响应给客户端的是完整的HTML页面内容 , 所以爬虫更容易获取信息, 更有利于SEO</li></ol><h4 id="缺点" tabindex="-1">缺点 <a class="header-anchor" href="#缺点" aria-label="Permalink to &quot;缺点&quot;">​</a></h4><ol><li><strong>占用服务端资源</strong> , 即服务器端完成HTML页面内容的拼接 , 如果请求过多 , 会对服务器造成一定的访问压力</li><li><strong>不利于前后端分离 , 开发效率低</strong> , 使用服务器端渲染 , 则无法进行分工合作 , 尤其是对于<strong>前端复杂度高</strong>的项目 , 不利于项目高效开发</li></ol><h2 id="前后端分离的web开发模式" tabindex="-1">前后端分离的web开发模式 <a class="header-anchor" href="#前后端分离的web开发模式" aria-label="Permalink to &quot;前后端分离的web开发模式&quot;">​</a></h2><p>前后端分离的概念</p><p><strong>前后端分离的开发模式 , 依赖于Ajax技术的广泛应用 , 简而言之 , 前后端分离的Web开发模式 , 就是后端只负责提供API接口 , 前端 使用Ajax调用接口的开发模式</strong></p><h3 id="优缺点" tabindex="-1">优缺点 <a class="header-anchor" href="#优缺点" aria-label="Permalink to &quot;优缺点&quot;">​</a></h3><h4 id="优点-1" tabindex="-1">优点 <a class="header-anchor" href="#优点-1" aria-label="Permalink to &quot;优点&quot;">​</a></h4><ol><li><strong>开发体验好</strong> , 前端专注于UI页面的开发 , 后端专注于API的开发 , 且后端有更多的选择性</li><li><strong>用户体验好</strong> , Ajax技术的广泛应用 , 极大地提高了用户的体验 , 可以轻松实现页面的局部刷新</li><li><strong>减轻了服务端的渲染压力</strong> , 页面最终是在每个用户的浏览器生成的, 不再是服务器生成的了</li></ol><h4 id="缺点-1" tabindex="-1">缺点 <a class="header-anchor" href="#缺点-1" aria-label="Permalink to &quot;缺点&quot;">​</a></h4><p><strong>不利于SEO</strong> , 因为完成的HTML页面需要在客户端动态拼接完成 , 所以爬虫无法爬取有效的信息.</p><p>但是可以使用Vue, React等前端框架的SSR技术很好地解决SEO问题</p><h2 id="如何选择web开发模式" tabindex="-1">如何选择Web开发模式 <a class="header-anchor" href="#如何选择web开发模式" aria-label="Permalink to &quot;如何选择Web开发模式&quot;">​</a></h2><p>web开发模式的选择要根据不同的业务场景</p><ul><li>比如<strong>企业级网站</strong> , 主要功能是展现内容,而没有复杂的交互,并且需要良好的SEO, 则这时我们可以选择服务端渲染</li><li>而类似于<strong>后台管理项目</strong> , 交互性比较强 , 需要不断地更新数据 , 不需要考虑SEO, 那么可以选择前后端分离的开发模式</li></ul><p>具体使用哪种开发模式不是绝对的</p><p>比如说, <strong>为了同时兼顾首页的渲染速度和前后端分离的开发效率</strong>, 有些网站采用 <strong>首页服务器端渲染+ 其他页面前后端分离</strong>的开发模式</p><h1 id="连接mysql数据库" tabindex="-1">连接MySQL数据库 <a class="header-anchor" href="#连接mysql数据库" aria-label="Permalink to &quot;连接MySQL数据库&quot;">​</a></h1><p>在学习Java的JDBC时, 需要导入一个第三方的驱动<code>jar</code>包 , 在Node.js中也差不多 , 需要导入<code>mysql</code>模块</p><h2 id="为什么需要导入模块" tabindex="-1">为什么需要导入模块 <a class="header-anchor" href="#为什么需要导入模块" aria-label="Permalink to &quot;为什么需要导入模块&quot;">​</a></h2><p>首先你要知道市面上大大小小的数据库产品几十款 , 每一款的开发商都不一样 , 每一款数据库的底层实现也是不一样 .</p><p>假如让每一个程序员都根据每一款数据库产品写一套API , 肯定是不太现实的 .</p><p>所以Node.js官方给出API的设计规范 , 每一个厂商都根据设计规范自主开发一套API , 并封装成模块.</p><p>这样, 程序员连接你家的数据库产品时 , 只需要导入这些封装好的API即可.</p><h2 id="在node-js中操作数据库" tabindex="-1">在Node.js中操作数据库 <a class="header-anchor" href="#在node-js中操作数据库" aria-label="Permalink to &quot;在Node.js中操作数据库&quot;">​</a></h2><h3 id="导入模块" tabindex="-1">导入模块 <a class="header-anchor" href="#导入模块" aria-label="Permalink to &quot;导入模块&quot;">​</a></h3><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">//安装模块</span></span>
<span class="line"><span style="color:#A6ACCD;">npm i mysql</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//导入模块</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> mysql </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">require</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">mysql</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span></code></pre></div><h3 id="获取链接" tabindex="-1">获取链接 <a class="header-anchor" href="#获取链接" aria-label="Permalink to &quot;获取链接&quot;">​</a></h3><p>首先通过<code>createConnection()</code>方法注册链接 , 返回一个链接的对象</p><p>接着调用此对象的<code>connect()</code> 向数据库发起链接</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">//返回一个链接对象</span></span>
<span class="line"><span style="color:#C792EA;">var</span><span style="color:#A6ACCD;"> connection </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> mysql</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">createConnection</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">host</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">localhost</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">user</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">root</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">password</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">123123</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">database</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">my_db</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">connection</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">connect</span><span style="color:#A6ACCD;">()</span></span></code></pre></div><p>参数名</p><ul><li><code>host</code> 主机域名</li><li><code>user</code> 用户名</li><li><code>password</code> 数据库密码</li><li><code>database</code> 指明我要连接哪一个库</li></ul><p>在使用<code>connection.connect()</code>连接数据库时,可能连接不上 , 这是就会报错,可以使用回调函数来处理</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">connection</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">connect</span><span style="color:#A6ACCD;">(</span><span style="color:#C792EA;">function</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">err</span><span style="color:#89DDFF;">){</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">err</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">连接失败!</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;">err</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">message</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">连接成功</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><h3 id="操作数据库" tabindex="-1">操作数据库 <a class="header-anchor" href="#操作数据库" aria-label="Permalink to &quot;操作数据库&quot;">​</a></h3><p>通过<code>connection.query()</code>来执行sql语句</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">connection</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">query</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">select * from user</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#C792EA;">function</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">err</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">results</span><span style="color:#89DDFF;">){</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//查询失败</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">err</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">err</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">message</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">   </span><span style="color:#676E95;font-style:italic;">//查询成功</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">results</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><p>第一个参数是待执行的sql语句</p><p>第二个参数是回调函数,这个回调函数的两个参数</p><ol><li>第一个参数<code>err</code>是一个错误对象, 当sql语句执行失败时, 会生成一个错误对象 , 传递给回调函数, 等待处理; 当sql执行成功时, <code>err = null</code>;</li><li>第二个参数是<code>results</code> , sql操作成功后会返回一个结果集 , 当sql语句执行失败时, <code>results=null</code></li></ol><p><strong>若执行的是查询操作 , results为一个数组 , 一行为一个单位</strong></p><p><img src="https://kkbank.oss-cn-qingdao.aliyuncs.com/note-img/image-20220505222329831.png" alt="image-20220505222329831"></p><p><strong>其他的操作 , results则为一个包含执行后状态的对象</strong></p><p><img src="https://kkbank.oss-cn-qingdao.aliyuncs.com/note-img/image-20220505222351667.png" alt="image-20220505222351667"></p><h3 id="预编译语句" tabindex="-1">预编译语句 <a class="header-anchor" href="#预编译语句" aria-label="Permalink to &quot;预编译语句&quot;">​</a></h3><p>前面的sql语句是通过字符串直接写好的 , sql语句是写死的 , 不能再变了 ,如果向再次执行类似的语句还要重新写一遍</p><p>这时候可以使用预编译的语句</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">var sqlStr </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">insert into users values(?,?,?)</span><span style="color:#89DDFF;">&#39;</span></span></code></pre></div><p>像这样, 在参数的位置使用问号<code>?</code>充当一个占位符 , 后期使用时只需要替换问号<code>?</code>的地方即可</p><p>在调用<code>connection.query()</code>方法时 , 需要传入预编译的sql语句 ,</p><p>如果只有一个<code>?</code>占位符, 那么第二个参数可以是数值型, 字符串 , 对象等</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">var</span><span style="color:#A6ACCD;"> sqlStr </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">select * from users where id = ?</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">connection</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">query</span><span style="color:#A6ACCD;">(sqlStr</span><span style="color:#89DDFF;">,</span><span style="color:#F78C6C;">2</span><span style="color:#89DDFF;">,</span><span style="color:#C792EA;">function</span><span style="color:#89DDFF;">(){</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">err</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">操作失败</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">results</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><p>如果有多个<code>?</code>占位符, 可以传入一个数组, 数组内的元素与占位符一一对应</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">var</span><span style="color:#A6ACCD;"> sqlStr </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">insert into users values(?,?,?)</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">connection</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">query</span><span style="color:#A6ACCD;">(sqlStr</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">[</span><span style="color:#F78C6C;">5</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">小王</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">10086</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">]</span><span style="color:#89DDFF;">,</span><span style="color:#C792EA;">function</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">err</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">result</span><span style="color:#89DDFF;">){</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">err</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">操作失败</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">   	</span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">err</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">affectedRows</span><span style="color:#89DDFF;">==</span><span style="color:#F78C6C;">1</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">插入数据成功</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><p><strong>插入数据的快捷方式</strong></p><p>如果数据对象的每个属性和表中的字段一一对应 , 那么可以直接传入一个对象</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">var</span><span style="color:#A6ACCD;"> sqlStr </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">insert into users set ?</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#C792EA;">var</span><span style="color:#A6ACCD;"> u{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#FFCB6B;">id</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">10</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#FFCB6B;">uname</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">小李</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#FFCB6B;">ph_num</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">10000</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">    </span></span>
<span class="line"><span style="color:#A6ACCD;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">connection</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">query</span><span style="color:#A6ACCD;">(sqlStr</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">u</span><span style="color:#89DDFF;">,(</span><span style="color:#A6ACCD;font-style:italic;">err</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;font-style:italic;">results</span><span style="color:#89DDFF;">)</span><span style="color:#C792EA;">=&gt;</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">	</span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">err</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">操作失败</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">results</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span></code></pre></div><h3 id="关闭链接" tabindex="-1">关闭链接 <a class="header-anchor" href="#关闭链接" aria-label="Permalink to &quot;关闭链接&quot;">​</a></h3><p>当数据库操作完成之后, 要及时关闭链接 , 防止连接占用大量的资源</p><p>调用<code>connection.end()</code>方法来关闭连接</p><h1 id="身份认证" tabindex="-1">身份认证 <a class="header-anchor" href="#身份认证" aria-label="Permalink to &quot;身份认证&quot;">​</a></h1><p>这个概念大家肯定都懂 ,就是通过各种手段, <strong>完成对用户身份的确认</strong></p><p>比如说, <strong>手机验证码登录 , 邮箱密码登录 , 二维码登录</strong>.....</p><h2 id="不同开发模式下的身份认证" tabindex="-1">不同开发模式下的身份认证 <a class="header-anchor" href="#不同开发模式下的身份认证" aria-label="Permalink to &quot;不同开发模式下的身份认证&quot;">​</a></h2><p>对于服务端渲染和前后端分离这两种开发模式,分别有不同的身份认证方案</p><ol><li><strong>服务端渲染</strong> 推荐使用<strong>Session认证机制</strong></li><li><strong>前后端分离</strong> 推荐使用<strong>JWT认证机制</strong></li></ol><h2 id="session认证机制" tabindex="-1">Session认证机制 <a class="header-anchor" href="#session认证机制" aria-label="Permalink to &quot;Session认证机制&quot;">​</a></h2><h3 id="http协议的无状态性" tabindex="-1">HTTP协议的无状态性 <a class="header-anchor" href="#http协议的无状态性" aria-label="Permalink to &quot;HTTP协议的无状态性&quot;">​</a></h3><p>HTTP协议的无状态性 , 是指<strong>客户端每次HTTP请求都是独立的</strong> , 连续多个请求之间没有直接的联系 , 服务器不会主动保留每次HTTP请求的状态</p><h3 id="突破http无状态的限制" tabindex="-1">突破HTTP无状态的限制 <a class="header-anchor" href="#突破http无状态的限制" aria-label="Permalink to &quot;突破HTTP无状态的限制&quot;">​</a></h3><p>在Web开发中使用**<code>Cookie</code>** 来突破HTTP无状态限制</p><h4 id="什么是cookie" tabindex="-1">什么是Cookie <a class="header-anchor" href="#什么是cookie" aria-label="Permalink to &quot;什么是Cookie&quot;">​</a></h4><p><strong><code>Cookie</code>是存储在用户浏览器中的一段不超过 4KB 的字符串</strong> , 它是由<strong>键值对</strong>的形式和其他几个用于控制Cookie<strong>有效期, 安全性 , 使用范围</strong>的可选属性组成的</p><p><strong>不同域名下的Cookie各自独立</strong> ,每当客户端发起请求时, <strong>会自动把当前域名下的所有未过期Cookie一同发送给服务器</strong></p><p><strong>Cookie的几大特性</strong></p><ol><li><strong>自动发送</strong></li><li><strong>域名独立</strong></li><li><strong>过期时限</strong></li><li><strong>4KB限制</strong></li></ol><h4 id="cookie在身份认证中的作用" tabindex="-1">Cookie在身份认证中的作用 <a class="header-anchor" href="#cookie在身份认证中的作用" aria-label="Permalink to &quot;Cookie在身份认证中的作用&quot;">​</a></h4><p>客户端<strong>第一次请求</strong>服务器的时候, 服务器通过<strong>响应头的形式</strong> ,向客户端发送一个身份认证的Cookie ,客户端会自动将Cookie保存在浏览器中</p><p>随后, 每当客户端浏览器再次发起请求时, 浏<strong>览器会自动将身份认证相关的Cookie , 通过请求头的形式发送给服务器</strong> , 服务器即可验证用户身份</p><p><img src="https://kkbank.oss-cn-qingdao.aliyuncs.com/note-img/image-20220503193555462.png" alt="image-20220503193555462"></p><h4 id="cookie具有不安全性" tabindex="-1">Cookie具有不安全性 <a class="header-anchor" href="#cookie具有不安全性" aria-label="Permalink to &quot;Cookie具有不安全性&quot;">​</a></h4><p><strong>由于Cookie是存储在浏览器中 , 而且浏览器也提供了读写Cookie的API , 因此Cooki很容易被认为的修改,不具有安全性</strong></p><p>因此,不建议服务器将重要的隐私数据, 通过Cookie的形式发送给浏览器</p><p>可以使用<strong>客户端浏览器Cookie + 服务器识别认证</strong> 来提高安全性</p><h4 id="session工作原理" tabindex="-1">Session工作原理 <a class="header-anchor" href="#session工作原理" aria-label="Permalink to &quot;Session工作原理&quot;">​</a></h4><p><img src="https://kkbank.oss-cn-qingdao.aliyuncs.com/note-img/image-20220503193900923.png" alt=""></p><h3 id="在express中使用session" tabindex="-1">在Express中使用Session <a class="header-anchor" href="#在express中使用session" aria-label="Permalink to &quot;在Express中使用Session&quot;">​</a></h3><p>在Express项目中 , 只需要安装<code>express-session</code>中间件 , 即可在项目中使用Session认证</p><p>安装<code>express-session</code>中间件</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">npm i express</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">session</span></span></code></pre></div><h4 id="配置express-session中间件" tabindex="-1">配置express-session中间件 <a class="header-anchor" href="#配置express-session中间件" aria-label="Permalink to &quot;配置express-session中间件&quot;">​</a></h4><p>使用<code>app.use()</code>来注册session中间件</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// 导入session中间件</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> session </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">require</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">express-session</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//配置session中间件</span></span>
<span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#A6ACCD;">(</span><span style="color:#82AAFF;">session</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">secret</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">lmk</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#676E95;font-style:italic;">//secret属性的值可以为任意字符串</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">resave</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">false</span><span style="color:#89DDFF;">,</span><span style="color:#676E95;font-style:italic;">//固定写法</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">saveUninitialized</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#676E95;font-style:italic;">//固定写法</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">))</span></span></code></pre></div><h4 id="向session中存数据" tabindex="-1">向session中存数据 <a class="header-anchor" href="#向session中存数据" aria-label="Permalink to &quot;向session中存数据&quot;">​</a></h4><p>当<code>express-session</code>中间件配置成功后 ,才能通过<code>req.session</code>对象来访问和使用session对象,从而存储用户的关键信息</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// 登录的 API 接口</span></span>
<span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">post</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/api/login</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">req</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// 判断用户提交的登录信息是否正确</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">req</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">body</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">username</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">!==</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">admin</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">||</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">req</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">body</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">password</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">!==</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">000000</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">send</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> status</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> msg</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">登录失败</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// TODO_02：请将登录成功后的用户信息，保存到 Session 中</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// 注意：只有成功配置了 express-session 这个中间件之后，才能够通过 req 点出来 session 这个属性</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//req.session内的变量是可以自定义的</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">req</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">session</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">user</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">req</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">body</span><span style="color:#F07178;"> </span><span style="color:#676E95;font-style:italic;">// 用户的信息</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">req</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">session</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">islogin</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#F07178;"> </span><span style="color:#676E95;font-style:italic;">// 用户的登录状态</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">send</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> status</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> msg</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">登录成功</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><h4 id="从session中取数据" tabindex="-1">从session中取数据 <a class="header-anchor" href="#从session中取数据" aria-label="Permalink to &quot;从session中取数据&quot;">​</a></h4><p>可以直接从<code>req.session</code>对象上获取之前存储的数据</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// 获取用户姓名的接口</span></span>
<span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/api/username</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">req</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// TODO_03：请从 Session 中获取用户的名称，响应给客户端</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">!</span><span style="color:#A6ACCD;">req</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">session</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">islogin</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">send</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> status</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> msg</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">fail</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">send</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    status</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    msg</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">success</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    username</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">req</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">session</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">user</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">username</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><h4 id="清空session" tabindex="-1">清空session <a class="header-anchor" href="#清空session" aria-label="Permalink to &quot;清空session&quot;">​</a></h4><p>调用<code>req.session.destroy()</code>函数 , 即可清空服务器保存的session信息</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// 退出登录的接口</span></span>
<span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">post</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/api/logout</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">req</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// TODO_04：清空 Session 信息</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">req</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">session</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">destroy</span><span style="color:#F07178;">()</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">send</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    status</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    msg</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">退出登录成功</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><h3 id="jwt认证机制" tabindex="-1">JWT认证机制 <a class="header-anchor" href="#jwt认证机制" aria-label="Permalink to &quot;JWT认证机制&quot;">​</a></h3><h4 id="session认证的局限性" tabindex="-1">Session认证的局限性 <a class="header-anchor" href="#session认证的局限性" aria-label="Permalink to &quot;Session认证的局限性&quot;">​</a></h4><p>Session认证机制<strong>需要配合Cookie才能实现</strong>。由于 Cookie 默认不支持跨域访问，所以，当涉及到前端跨域请求后端接口的时候，<strong>需要做很多额外的配置</strong>，才能实现跨域 Session 认证。</p><p>注意：</p><ul><li>当前端请求后端接口<strong>不存在跨域问题</strong>的时候，<strong>推荐使用</strong> <strong>Session</strong> 身份认证机制。</li><li>当前端需要跨域请求后端接口的时候，不推荐使用 Session 身份认证机制，推荐使用 JWT 认证机制。</li></ul><h4 id="什么是jwt" tabindex="-1">什么是JWT <a class="header-anchor" href="#什么是jwt" aria-label="Permalink to &quot;什么是JWT&quot;">​</a></h4><p>JSON Web Token的缩写 , 是目前最流行的跨域认证解决方案</p><h4 id="jwt工作原理" tabindex="-1">JWT工作原理 <a class="header-anchor" href="#jwt工作原理" aria-label="Permalink to &quot;JWT工作原理&quot;">​</a></h4><p><img src="https://kkbank.oss-cn-qingdao.aliyuncs.com/note-img/image-20220504210452645.png" alt="image-20220504210452645"></p><p>用户首次登录时, 服务器经过加密会生成一个Token字符串 , 服务器将这个Token字符串响应给客户端, 客户端将Token存储在LocalStorage或SessionStorage中</p><p>客户端再次发起请求时,通过请求头的<code>Authorization</code>字段, 将Token发送给服务器, 服务器把Token还原成用户的信息对象 , 根据不同的用户身份响应不同的内容</p><h4 id="jwt的组成部分" tabindex="-1">JWT的组成部分 <a class="header-anchor" href="#jwt的组成部分" aria-label="Permalink to &quot;JWT的组成部分&quot;">​</a></h4><p>JWT字符串通常由三部分组成 , 分别是<strong>Header(头部)</strong> , <strong>Payload(有效荷载)</strong> , <strong>Signature(签名)</strong></p><p>三者之间英文的 点 <code>.</code>分隔, 只是为了起分隔作用</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">Header</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">Payload</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">Signature</span></span></code></pre></div><p>注意</p><ul><li><strong>Payload</strong>部分才是真正的用户信息 , 他<strong>是用户信息经过加密之后生成的字符串</strong></li><li>Header和Signature是<strong>安全相关的部分</strong> , 只是为了保证Token的安全性</li></ul><h4 id="jwt的使用方式" tabindex="-1">JWT的使用方式 <a class="header-anchor" href="#jwt的使用方式" aria-label="Permalink to &quot;JWT的使用方式&quot;">​</a></h4><p>客户端收到服务器返回的JWT之后 , 通常会将它存储在<strong>localStorage</strong> 或 <strong>sessionStorage</strong>中</p><p>此后 , 客户端每次与服务器通信, 都会带上这个JWT字符串 , 从而进行身份认证</p><p>推荐的做法是<strong>将JWT放在HTTP请求头的Authorization字段中</strong> , 格式如下</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">Authorization</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> Bearer </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">token</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//必须要加一个Bearer否则不能正常解析</span></span></code></pre></div><h3 id="在express中生成token" tabindex="-1">在express中生成Token <a class="header-anchor" href="#在express中生成token" aria-label="Permalink to &quot;在express中生成Token&quot;">​</a></h3><p>首先第一步 , 还是安装包 , 需要安装两个包</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">npm i jsonwebtoken express-jwt</span></span></code></pre></div><p>其中:</p><ul><li><strong>jsonwebtoken</strong> 用于<strong>生成JWT字符串</strong></li><li><strong>express-jwt</strong> 用于将<strong>JWT字符串解析还原成JSON对象</strong></li></ul><h4 id="定义secret密钥" tabindex="-1">定义secret密钥 <a class="header-anchor" href="#定义secret密钥" aria-label="Permalink to &quot;定义secret密钥&quot;">​</a></h4><p>为了<strong>保证JWT字符串的安全性</strong>, 防止JWT字符串在网络传输过程中被别人破解 , 我么需要定义一个用于加密和解密的secret密钥</p><ol><li>当生成JWT字符串时, 需要使用secret密钥对用户信息进行<strong>加密</strong> , 最终得到加密好的JWT字符串</li><li>当把JWT字符串解析成JSON对象时, 需要使用同一个secret密钥进行解密</li></ol><p>就是定义一个字符串, 这个字符串越复杂越好</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">const secretKey = &#39;liu_ming&amp;kai!&#39;</span></span></code></pre></div><h4 id="生成jwt字符串" tabindex="-1">生成JWT字符串 <a class="header-anchor" href="#生成jwt字符串" aria-label="Permalink to &quot;生成JWT字符串&quot;">​</a></h4><p>调用<code>jsonwebtoken</code>包中的<code>sign()</code>方法 , 将用户的信息加密成JWT字符串 , 响应给客户端</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">//定义一个密钥</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> secretKey </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">liu_ming&amp;kai!</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 调用 jwt.sign() 方法生成 JWT 字符串。并通过 token 属性发送给客户端</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 参数1：用户的信息对象</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 参数2：加密的秘钥</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 参数3：配置对象，可以配置当前 token 的有效期 , 30s---30秒内有效</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//		30h ---30小时内有效</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> tokenStr </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> jwt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">sign</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">username</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> userinfo</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">username </span><span style="color:#89DDFF;">},</span><span style="color:#A6ACCD;"> secretKey</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">expiresIn</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">30s</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">  res</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">send</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">status</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">200</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">message</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">登录成功！</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">token</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> tokenStr</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">// 要发送给客户端的 token 字符串</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><p><strong>记住：千万不要把密码加密到 token 字符中</strong></p><h4 id="解析jwt字符串" tabindex="-1">解析JWT字符串 <a class="header-anchor" href="#解析jwt字符串" aria-label="Permalink to &quot;解析JWT字符串&quot;">​</a></h4><p>将JWT字符串还原为JSON对象</p><p>客户端每次在访问那些有权限接口的时候 , 需要主动地在<strong>请求头中的Authorization</strong> , 将Token字符串发送给服务器进行认证</p><p>可以通过<code>express-jwt</code>这个中间件 , 自动将客户端发送过来的Token解析成JSON对象</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">//使用app.use()来注册中间件</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//expressJWT({secret: secretKey}) 就是中间件</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//.unless({path:[/^\/api\//]}) 用来指定哪些接口不需要设定访问权限</span></span>
<span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#A6ACCD;">(</span><span style="color:#82AAFF;">expressJWT</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span><span style="color:#F07178;">secret</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">secretKey</span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">unless</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span><span style="color:#F07178;">path</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">[</span><span style="color:#89DDFF;">/</span><span style="color:#89DDFF;font-style:italic;">^</span><span style="color:#A6ACCD;">\/</span><span style="color:#C3E88D;">api</span><span style="color:#A6ACCD;">\/</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">]</span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">))</span></span></code></pre></div><p>当express-jwt这个中间件配置成功后 , <code>req</code> 中就会多一个<code>user</code>对象 ,通过<code>req.user</code>对象访问从JWT字符串中解析出来的用户信息</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">//只要配置完express-jwt中间件后,就会将解析出来的用户信息挂载到req.user对象身上</span></span>
<span class="line"><span style="color:#A6ACCD;">// 使用 req.user 获取用户信息，并使用 data 属性将用户信息发送给客户端</span></span>
<span class="line"><span style="color:#A6ACCD;">console.log(req.user)</span></span>
<span class="line"><span style="color:#A6ACCD;">res.send({</span></span>
<span class="line"><span style="color:#A6ACCD;">   status: 200,</span></span>
<span class="line"><span style="color:#A6ACCD;">   message: &#39;获取用户信息成功！&#39;,</span></span>
<span class="line"><span style="color:#A6ACCD;">   data: req.user, // 要发送给客户端的用户信息</span></span>
<span class="line"><span style="color:#A6ACCD;">})</span></span></code></pre></div><h4 id="jwt解析错误" tabindex="-1">JWT解析错误 <a class="header-anchor" href="#jwt解析错误" aria-label="Permalink to &quot;JWT解析错误&quot;">​</a></h4><p>当使用 express-jwt 解析 Token 字符串时，如果客户端发送过来的 Token 字符串<strong>过期</strong>或<strong>不合法</strong>，会产生一个<strong>解析失败</strong>的错误，影响项目的正常运行。我们可以通过 <strong>Express</strong> <strong>的错误中间件</strong>，捕获这个错误并进行相关的处理，示例代码如下：</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">//使用app.use()注册一个错误中间件</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//捕获解析 JWT 失败后产生的错误</span></span>
<span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">err</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">req</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">res</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">next</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// 这次错误是由 token 解析失败导致的</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">err</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">name</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">UnauthorizedError</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">send</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      status</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">401</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">      message</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">无效的token</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">send</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    status</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">500</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    message</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">未知的错误</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span></code></pre></div></div></div></main><footer class="VPDocFooter" data-v-e9631fd0 data-v-face870a><!--[--><!--]--><!----><div class="prev-next" data-v-face870a><div class="pager" data-v-face870a><a class="pager-link prev" href="/notes/front/TS.html" data-v-face870a><span class="desc" data-v-face870a>Previous page</span><span class="title" data-v-face870a>TS</span></a></div><div class="has-prev pager" data-v-face870a><a class="pager-link next" href="/notes/front/Vue2.html" data-v-face870a><span class="desc" data-v-face870a>Next page</span><span class="title" data-v-face870a>Vue2</span></a></div></div></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-99cf8a88 data-v-f4388a15><div class="container" data-v-f4388a15><p class="message" data-v-f4388a15>本网站基于VitePress构建&nbsp;&nbsp;&nbsp;仅用于学习途径</p><p class="copyright" data-v-f4388a15>2023 © Mingkai Liu</p></div></footer><!--[--><!--]--></div></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"guide_front_index.md\":\"4907220e\",\"index.md\":\"7260750d\",\"guide_springcloud_index.md\":\"b4e11e8e\",\"guide_start.md\":\"7f88d24e\",\"guide_ssm_index.md\":\"1a45e4f8\",\"notes_front_html5.md\":\"107f9e7a\",\"notes_springcloud_nginx.md\":\"b82bd0b4\",\"notes_springcloud_docker.md\":\"3bfd23a1\",\"notes_springcloud_quartz定时组件.md\":\"9333b7fd\",\"notes_springcloud_rabbitmq.md\":\"894a3eae\",\"notes_springcloud_elasticsearch.md\":\"ff882afa\",\"notes_front_ts.md\":\"bcbc9deb\",\"notes_ssm_mybatis-plus复习.md\":\"57e4302a\",\"函数式编程.md\":\"b332e463\",\"利用vitepress部署静态网站.md\":\"72235f38\",\"notes_front_html_css.md\":\"ea1ce18b\",\"notes_ssm_springboot.md\":\"9532bd6c\",\"notes_front_node.md\":\"57ecb1bf\",\"notes_ssm_springmvc.md\":\"5d7ffbd1\",\"mybatis复习.md\":\"5521ac89\",\"notes_ssm_spring.md\":\"30d7b79c\",\"notes_front_vue3.md\":\"a09fe61e\",\"notes_front_js汇总.md\":\"47b65609\",\"notes_ssm_mybatis复习.md\":\"6f01e827\",\"notes_front_vue2.md\":\"101158f0\",\"notes_ssm_springsecurity.md\":\"0b0fa7b9\",\"notes_ssm_spring复习.md\":\"7a350023\"}")
__VP_SITE_DATA__ = JSON.parse("{\"lang\":\"zh-cn\",\"dir\":\"ltr\",\"title\":\"刘明凯的学习笔记\",\"description\":\"本网站是基于GitHubPage和VitePress构建, 用来存放刘明凯的学习笔记\",\"base\":\"/\",\"head\":[],\"appearance\":true,\"themeConfig\":{\"nav\":[{\"text\":\"SSM\",\"link\":\"/guide/ssm/\"},{\"text\":\"前端\",\"link\":\"/guide/front/\"},{\"text\":\"SpringCloud\",\"link\":\"/guide/springcloud/\"}],\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/LMKKK\"},{\"icon\":{\"svg\":\"<svg t=\\\"1688885876384\\\" class=\\\"icon\\\" viewBox=\\\"0 0 1024 1024\\\" version=\\\"1.1\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" p-id=\\\"1454\\\" xmlns:xlink=\\\"http://www.w3.org/1999/xlink\\\" width=\\\"200\\\" height=\\\"200\\\"><path d=\\\"M512 0c282.784 0 512 229.216 512 512s-229.216 512-512 512S0 794.784 0 512 229.216 0 512 0z m189.952 752l11.2-108.224c-31.904 9.536-100.928 16.128-147.712 16.128-134.464 0-205.728-47.296-195.328-146.304 11.584-110.688 113.152-145.696 232.64-145.696 54.784 0 122.432 8.8 151.296 18.336L768 272.704C724.544 262.24 678.272 256 599.584 256c-203.2 0-388.704 94.88-406.4 263.488C178.336 660.96 303.584 768 535.616 768c80.672 0 138.464-6.432 166.336-16z\\\" fill=\\\"#CE000D\\\" p-id=\\\"1455\\\"></path></svg>\"},\"link\":\"https://itkkk.blog.csdn.net\",\"ariaLabel\":\"秋天Code的博客\"},{\"icon\":{\"svg\":\"<svg t=\\\"1688885971929\\\" class=\\\"icon\\\" viewBox=\\\"0 0 1129 1024\\\" version=\\\"1.1\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" p-id=\\\"1755\\\" xmlns:xlink=\\\"http://www.w3.org/1999/xlink\\\" width=\\\"220.5078125\\\" height=\\\"200\\\"><path d=\\\"M234.909 9.656a80.468 80.468 0 0 1 68.398 0 167.374 167.374 0 0 1 41.843 30.578l160.937 140.82h115.07l160.936-140.82a168.983 168.983 0 0 1 41.843-30.578A80.468 80.468 0 0 1 930.96 76.445a80.468 80.468 0 0 1-17.703 53.914 449.818 449.818 0 0 1-35.406 32.187 232.553 232.553 0 0 1-22.531 18.508h100.585a170.593 170.593 0 0 1 118.289 53.109 171.397 171.397 0 0 1 53.914 118.288v462.693a325.897 325.897 0 0 1-4.024 70.007 178.64 178.64 0 0 1-80.468 112.656 173.007 173.007 0 0 1-92.539 25.75h-738.7a341.186 341.186 0 0 1-72.421-4.024A177.835 177.835 0 0 1 28.91 939.065a172.202 172.202 0 0 1-27.36-92.539V388.662a360.498 360.498 0 0 1 0-66.789A177.03 177.03 0 0 1 162.487 178.64h105.414c-16.899-12.07-31.383-26.555-46.672-39.43a80.468 80.468 0 0 1-25.75-65.984 80.468 80.468 0 0 1 39.43-63.57M216.4 321.873a80.468 80.468 0 0 0-63.57 57.937 108.632 108.632 0 0 0 0 30.578v380.615a80.468 80.468 0 0 0 55.523 80.469 106.218 106.218 0 0 0 34.601 5.632h654.208a80.468 80.468 0 0 0 76.444-47.476 112.656 112.656 0 0 0 8.047-53.109v-354.06a135.187 135.187 0 0 0 0-38.625 80.468 80.468 0 0 0-52.304-54.719 129.554 129.554 0 0 0-49.89-7.242H254.22a268.764 268.764 0 0 0-37.82 0z m0 0\\\" fill=\\\"#20B0E3\\\" p-id=\\\"1756\\\"></path><path d=\\\"M348.369 447.404a80.468 80.468 0 0 1 55.523 18.507 80.468 80.468 0 0 1 28.164 59.547v80.468a80.468 80.468 0 0 1-16.094 51.5 80.468 80.468 0 0 1-131.968-9.656 104.609 104.609 0 0 1-10.46-54.719v-80.468a80.468 80.468 0 0 1 70.007-67.593z m416.02 0a80.468 80.468 0 0 1 86.102 75.64v80.468a94.148 94.148 0 0 1-12.07 53.11 80.468 80.468 0 0 1-132.773 0 95.757 95.757 0 0 1-12.875-57.133V519.02a80.468 80.468 0 0 1 70.007-70.812z m0 0\\\" fill=\\\"#20B0E3\\\" p-id=\\\"1757\\\"></path></svg>\"},\"link\":\"https://space.bilibili.com/2071205694\",\"ariaLabel\":\"我的bilibili\"},{\"icon\":{\"svg\":\"<svg t=\\\"1688886279240\\\" class=\\\"icon\\\" viewBox=\\\"0 0 1024 1024\\\" version=\\\"1.1\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" p-id=\\\"2089\\\" width=\\\"200\\\" height=\\\"200\\\"><path d=\\\"M228.7 643.9c-0.1 0.1-0.2 0.3-0.3 0.4 3.9-4.4 8-9 12-13.5-7.5 8.4-11.7 13.1-11.7 13.1z\\\" fill=\\\"#1590E9\\\" p-id=\\\"2090\\\"></path><path d=\\\"M894 298.1l25.6-15.1c10.4-6.1 9.1-21.5-2.1-25.9l-12.3-4.8c-18-7.1-34.2-18.2-46.7-33-15.7-18.5-44.7-45.1-90.9-60.8-52.7-18-142.9-14.4-193.2-10.5-15.9 1.2-25 18.4-17.4 32.5 42.6 78.6 16.7 114.3-5.7 140.7-34.3 40.4-97.4 112.2-160.7 183.6 21.9-24.5 41.8-46.8 58.1-65.1 36.4-40.8 91.3-61.5 145.1-51.7 171.5 31.3 191 253.4-9.2 385.6 26.1-1.4 52.6-3.3 79.2-6 252.6-26 272.6-232.1 218-333.9-19.4-36.1-22.2-60.5-20.1-83.9 2-21.5 13.8-40.8 32.3-51.7z\\\" fill=\\\"#99C236\\\" p-id=\\\"2091\\\"></path><path d=\\\"M212.8 704.5C241.1 672.9 316 589 390.7 504.7c-54.6 61.2-121.8 136.7-177.9 199.8z\\\" fill=\\\"#1590E9\\\" p-id=\\\"2092\\\"></path><path d=\\\"M216.3 758.6c-19.5-2.5-28.2-25.6-15.5-40.6-51.7 58.3-91.7 103.5-99.1 112.6-24.1 29.5 247.7 97.9 482.6-56.8 0.1-0.1 0.3-0.2 0.4-0.3-156.5 8.2-298.5-5.9-368.4-14.9z\\\" fill=\\\"#CAC134\\\" p-id=\\\"2093\\\"></path><path d=\\\"M593.9 387.9c-53.8-9.8-108.7 10.9-145.1 51.7-16.3 18.2-36.2 40.5-58.1 65.1C316 589 241.1 672.9 212.8 704.5c-4.1 4.6-8.1 9.1-12 13.5-12.7 14.9-4 38 15.5 40.6 69.9 9 211.9 23.1 368.3 15 200.2-132.3 180.8-354.4 9.3-385.7z\\\" fill=\\\"#029F40\\\" p-id=\\\"2094\\\"></path></svg>\"},\"link\":\"https://www.yuque.com/kkcode/\"}],\"sidebar\":{\"/guide/front/\":[{\"text\":\"HTML+CSS\",\"link\":\"/notes/front/HTML+CSS\"},{\"text\":\"HTML5\",\"link\":\"/notes/front/HTML5\"},{\"text\":\"JS汇总\",\"link\":\"/notes/front/JS汇总\"},{\"text\":\"TS\",\"link\":\"/notes/front/TS\"},{\"text\":\"Node\",\"link\":\"/notes/front/Node\"},{\"text\":\"Vue2\",\"link\":\"/notes/front/Vue2\"},{\"text\":\"Vue3\",\"link\":\"/notes/front/Vue3\"}],\"/notes/front/\":[{\"text\":\"HTML+CSS\",\"link\":\"/notes/front/HTML+CSS\"},{\"text\":\"HTML5\",\"link\":\"/notes/front/HTML5\"},{\"text\":\"JS汇总\",\"link\":\"/notes/front/JS汇总\"},{\"text\":\"TS\",\"link\":\"/notes/front/TS\"},{\"text\":\"Node\",\"link\":\"/notes/front/Node\"},{\"text\":\"Vue2\",\"link\":\"/notes/front/Vue2\"},{\"text\":\"Vue3\",\"link\":\"/notes/front/Vue3\"}],\"/guide/ssm/\":[{\"text\":\"MyBatis复习\",\"link\":\"/notes/ssm/MyBatis复习\"},{\"text\":\"MyBatis-Plus复习\",\"link\":\"/notes/ssm/MyBatis-Plus复习\"},{\"text\":\"Spring\",\"link\":\"/notes/ssm/Spring\"},{\"text\":\"SpringMVC\",\"link\":\"/notes/ssm/SpringMVC\"},{\"text\":\"SpringBoot\",\"link\":\"/notes/ssm/SpringBoot\"},{\"text\":\"SpringSecurity\",\"link\":\"/notes/ssm/SpringSecurity\"},{\"text\":\"Spring复习\",\"link\":\"/notes/ssm/Spring复习\"}],\"/notes/ssm/\":[{\"text\":\"MyBatis复习\",\"link\":\"/notes/ssm/MyBatis复习\"},{\"text\":\"MyBatis-Plus复习\",\"link\":\"/notes/ssm/MyBatis-Plus复习\"},{\"text\":\"Spring\",\"link\":\"/notes/ssm/Spring\"},{\"text\":\"SpringMVC\",\"link\":\"/notes/ssm/SpringMVC\"},{\"text\":\"SpringBoot\",\"link\":\"/notes/ssm/SpringBoot\"},{\"text\":\"SpringSecurity\",\"link\":\"/notes/ssm/SpringSecurity\"},{\"text\":\"Spring复习\",\"link\":\"/notes/ssm/Spring复习\"}],\"/guide/springcloud/\":[{\"text\":\"Docker\",\"link\":\"/notes/springcloud/Docker\"},{\"text\":\"ElasticSearch\",\"link\":\"/notes/springcloud/ElasticSearch\"},{\"text\":\"Quartz定时组件\",\"link\":\"/notes/springcloud/Quartz定时组件\"},{\"text\":\"RabbitMQ\",\"link\":\"/notes/springcloud/RabbitMQ\"},{\"text\":\"Nginx\",\"link\":\"/notes/springcloud/Nginx\"}],\"/notes/springcloud\":[{\"text\":\"Docker\",\"link\":\"/notes/springcloud/Docker\"},{\"text\":\"ElasticSearch\",\"link\":\"/notes/springcloud/ElasticSearch\"},{\"text\":\"Quartz定时组件\",\"link\":\"/notes/springcloud/Quartz定时组件\"},{\"text\":\"RabbitMQ\",\"link\":\"/notes/springcloud/RabbitMQ\"},{\"text\":\"Nginx\",\"link\":\"/notes/springcloud/Nginx\"}]},\"footer\":{\"message\":\"本网站基于VitePress构建&nbsp;&nbsp;&nbsp;仅用于学习途径\",\"copyright\":\"2023 © Mingkai Liu\"},\"search\":{\"provider\":\"local\"}},\"locales\":{},\"scrollOffset\":90,\"cleanUrls\":false}")</script>
    
  </body>
</html>